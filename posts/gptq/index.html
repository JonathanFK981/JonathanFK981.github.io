<!DOCTYPE html>
<html lang="zh-Hans"
  x-data
  :class="$store.darkMode.class()"
  :data-theme="$store.darkMode.theme()">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPTQ | dO.ob&#39;s Blog</title>

    

<link rel="canonical" href="http://localhost:1313/posts/gptq/" />



<meta name="author" content="Author Name" />
<meta name="description" content="é¦–å…ˆï¼Œæ¨¡å‹å‹ç¼©çš„æ–¹æ³•éœ€è¦model retrainingï¼Œä¾‹å¦‚ä½æ¯”ç‰¹ä½å®½é‡åŒ–å’Œå‰ªæã€‚
å…¶æ¬¡ï¼Œä½¿ç”¨one-shotçš„post-trainingæ–¹æ³•è¾ƒä¸ºå¤æ‚
æœ€åï¼Œround-to-nearestçš„é‡åŒ–æ–¹æ³•åœ¨8-bitçš„æƒé‡ä¸Šèµ·äº†ä½œç”¨ï¼Œä½†åœ¨é«˜é€Ÿæƒ…å†µä¸‹ä¸èƒ½ä¿æŒç²¾åº¦
GPTQçš„ä¸€å¤§æ”¹è¿›ï¼š
1.å¯ä»¥å°†æ¨¡å‹å‹ç¼©åˆ°3-bitæˆ–è€…4-bitä¸”ä¸ä¼šæ˜¾è‘—é™ä½ç²¾åº¦
" />


<meta name="keywords" content="Tag1,Tag2">



<meta name="generator" content="Hugo 0.146.2">


<meta property="og:url" content="http://localhost:1313/posts/gptq/">
  <meta property="og:site_name" content="dO.ob&#39;s Blog">
  <meta property="og:title" content="GPTQ">
  <meta property="og:description" content="é¦–å…ˆï¼Œæ¨¡å‹å‹ç¼©çš„æ–¹æ³•éœ€è¦model retrainingï¼Œä¾‹å¦‚ä½æ¯”ç‰¹ä½å®½é‡åŒ–å’Œå‰ªæã€‚
å…¶æ¬¡ï¼Œä½¿ç”¨one-shotçš„post-trainingæ–¹æ³•è¾ƒä¸ºå¤æ‚
æœ€åï¼Œround-to-nearestçš„é‡åŒ–æ–¹æ³•åœ¨8-bitçš„æƒé‡ä¸Šèµ·äº†ä½œç”¨ï¼Œä½†åœ¨é«˜é€Ÿæƒ…å†µä¸‹ä¸èƒ½ä¿æŒç²¾åº¦
GPTQçš„ä¸€å¤§æ”¹è¿›ï¼š
1.å¯ä»¥å°†æ¨¡å‹å‹ç¼©åˆ°3-bitæˆ–è€…4-bitä¸”ä¸ä¼šæ˜¾è‘—é™ä½ç²¾åº¦">
  <meta property="og:locale" content="zh_Hans">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-17T19:28:19+08:00">
    <meta property="article:modified_time" content="2025-04-17T19:28:19+08:00">
    <meta property="article:tag" content="Tag1">
    <meta property="article:tag" content="Tag2">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="GPTQ">
  <meta name="twitter:description" content="é¦–å…ˆï¼Œæ¨¡å‹å‹ç¼©çš„æ–¹æ³•éœ€è¦model retrainingï¼Œä¾‹å¦‚ä½æ¯”ç‰¹ä½å®½é‡åŒ–å’Œå‰ªæã€‚
å…¶æ¬¡ï¼Œä½¿ç”¨one-shotçš„post-trainingæ–¹æ³•è¾ƒä¸ºå¤æ‚
æœ€åï¼Œround-to-nearestçš„é‡åŒ–æ–¹æ³•åœ¨8-bitçš„æƒé‡ä¸Šèµ·äº†ä½œç”¨ï¼Œä½†åœ¨é«˜é€Ÿæƒ…å†µä¸‹ä¸èƒ½ä¿æŒç²¾åº¦
GPTQçš„ä¸€å¤§æ”¹è¿›ï¼š
1.å¯ä»¥å°†æ¨¡å‹å‹ç¼©åˆ°3-bitæˆ–è€…4-bitä¸”ä¸ä¼šæ˜¾è‘—é™ä½ç²¾åº¦">




<link rel="stylesheet" href="/css/output.css" />




<script>
  MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)']],
      displayMath: [['$$','$$']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 


    
<script>
  MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)'], ['$', '$']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 


    


<style>
  pre {
    padding: 1em;
    overflow: auto;
  }
</style>









    

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js" integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin="anonymous"></script>
  </head>

  <body x-data="{
    flip: false,
  }">
    
    <div id="dream-global-bg"></div>

    
<nav class="mt-4 lg:mt-8 py-4">

  
  <div class="container flex justify-between max-w-[65ch] mx-auto px-4 md:px-0">
  
    <section class="flex items-center gap-4">
      <div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title="ç¿»è½¬ä¸€ä¸‹ï¼">
        <div class="h-10 rounded-full">
          <img src="/img/logo.jpg" alt="Jonathan&#39;s Blog" />
        </div>
      </div>

      
      <div>
        
        <a href="http://localhost:1313/" class="text-lg font-semibold cursor-pointer">
          Jonathan&#39;s Blog
        </a>
        
        
      </div>
      
    </section>

    
    

    <div class="dropdown dropdown-end sm:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-square" aria-label="Select an option">
        <ion-icon name="menu" class="text-2xl"></ion-icon>
      </div>
      <ul tabindex="0" class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md">
        







<li>
  <div role="link" tabindex="0" class="inline-flex items-center p-2 cursor-pointer" @click="flip = !flip" title="å…³äº">
    <ion-icon name="information-circle"></ion-icon>å…³äº</div>
</li>





















<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/posts" title="å½’æ¡£">
    <ion-icon name="archive"></ion-icon>
    å½’æ¡£
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/categories" title="æ‰€æœ‰åˆ†ç±»">
    <ion-icon name="grid"></ion-icon>
    æ‰€æœ‰åˆ†ç±»
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/tags" title="æ‰€æœ‰æ ‡ç­¾">
    <ion-icon name="pricetags"></ion-icon>
    æ‰€æœ‰æ ‡ç­¾
  </a>
</li>






      </ul>
    </div>
    <section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4">
      

      
      




<div role="link" tabindex="0" class="text-sm font-semibold cursor-pointer hover:underline" @click="flip = !flip" title="å…³äº">å…³äº</div>





      
      





      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/posts" title="å½’æ¡£">
  <ion-icon class="group-hover:text-primary-content" name="archive"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/categories" title="æ‰€æœ‰åˆ†ç±»">
  <ion-icon class="group-hover:text-primary-content" name="grid"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/tags" title="æ‰€æœ‰æ ‡ç­¾">
  <ion-icon class="group-hover:text-primary-content" name="pricetags"></ion-icon>
</a>


      

      

      
    </section>
  </div>
</nav>


    <div class="flip-container" :class="{ 'flip-it': flip }">
      <div class="flipper">
        <div class="front">
          <div class="container">
            
<div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4">
  <div class="hidden lg:block">
    
  </div>

  <div class="lg:col-span-2">
    <article class="mx-auto prose prose-quoteless dark:prose-invert" id="dream-single-post-main" itemscope itemtype="http://schema.org/Article">
      
  <meta itemprop="name" content="GPTQ">
  <meta itemprop="description" content="é¦–å…ˆï¼Œæ¨¡å‹å‹ç¼©çš„æ–¹æ³•éœ€è¦model retrainingï¼Œä¾‹å¦‚ä½æ¯”ç‰¹ä½å®½é‡åŒ–å’Œå‰ªæã€‚
å…¶æ¬¡ï¼Œä½¿ç”¨one-shotçš„post-trainingæ–¹æ³•è¾ƒä¸ºå¤æ‚
æœ€åï¼Œround-to-nearestçš„é‡åŒ–æ–¹æ³•åœ¨8-bitçš„æƒé‡ä¸Šèµ·äº†ä½œç”¨ï¼Œä½†åœ¨é«˜é€Ÿæƒ…å†µä¸‹ä¸èƒ½ä¿æŒç²¾åº¦
GPTQçš„ä¸€å¤§æ”¹è¿›ï¼š
1.å¯ä»¥å°†æ¨¡å‹å‹ç¼©åˆ°3-bitæˆ–è€…4-bitä¸”ä¸ä¼šæ˜¾è‘—é™ä½ç²¾åº¦">
  <meta itemprop="datePublished" content="2025-04-17T19:28:19+08:00">
  <meta itemprop="dateModified" content="2025-04-17T19:28:19+08:00">
  <meta itemprop="wordCount" content="312">
  <meta itemprop="keywords" content="Tag1,Tag2">

      <header>
        <h1 itemprop="headline">GPTQ</h1>
        <p class="text-sm">
          
            æ˜ŸæœŸå››, 4æœˆ 17, 2025
          

          | <span>2åˆ†é’Ÿé˜…è¯»</span>

          
          | <span>æ›´æ–°äº
            
              æ˜ŸæœŸå››, 4æœˆ 17, 2025
            </span>
          
        </p>

        
        <div class="flex justify-between">
          
            <div class="flex items-center">
  
  <span>@</span>
  

  <span itemprop="author" itemscope itemtype="https://schema.org/Person">
  
    
      <span itemprop="name">Author Name</span>
    
  
  </span>
</div>

          

          <div class="flex items-center gap-2">
  
  

  
  
  
  
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://x.com/intent/post?text=GPTQ&amp;url=http://localhost:1313/posts/gptq/" target="_blank" rel="noopener noreferrer"
      title="Share on X">
      <ion-icon class="group-hover:text-primary-content" name="logo-x"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://facebook.com/sharer/sharer.php?u=http://localhost:1313/posts/gptq/" target="_blank" rel="noopener noreferrer"
      title="Share on Facebook">
      <ion-icon class="group-hover:text-primary-content" name="logo-facebook"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://wa.me/?text=GPTQ%20http://localhost:1313/posts/gptq/" target="_blank" rel="noopener noreferrer"
      title="Share on WhatsApp">
      <ion-icon class="group-hover:text-primary-content" name="logo-whatsapp"></ion-icon>
    </a>
  

  
  
</div>

        </div>
      </header>

      <section id="dream-single-post-content" itemprop="articleBody">
        
          <img class="w-full z-30" src="/img/a.jpg" alt="GPTQ" />
        

        <p>é¦–å…ˆï¼Œæ¨¡å‹å‹ç¼©çš„æ–¹æ³•éœ€è¦model retrainingï¼Œä¾‹å¦‚ä½æ¯”ç‰¹ä½å®½é‡åŒ–å’Œå‰ªæã€‚</p>
<p>å…¶æ¬¡ï¼Œä½¿ç”¨one-shotçš„post-trainingæ–¹æ³•è¾ƒä¸ºå¤æ‚</p>
<p>æœ€åï¼Œround-to-nearestçš„é‡åŒ–æ–¹æ³•åœ¨8-bitçš„æƒé‡ä¸Šèµ·äº†ä½œç”¨ï¼Œä½†åœ¨é«˜é€Ÿæƒ…å†µä¸‹ä¸èƒ½ä¿æŒç²¾åº¦</p>
<p>GPTQçš„ä¸€å¤§æ”¹è¿›ï¼š</p>
<p>1.å¯ä»¥å°†æ¨¡å‹å‹ç¼©åˆ°3-bitæˆ–è€…4-bitä¸”ä¸ä¼šæ˜¾è‘—é™ä½ç²¾åº¦</p>
<h1 id="background">BACKGROUND</h1>
<h2 id="layer-wise-quantization">Layer-Wise Quantization</h2>
<p>ä»é«˜å±‚æ¬¡æ¥çœ‹ï¼Œå›¢é˜Ÿçš„æ–¹æ³•éµå¾ªäº†æœ€å…ˆè¿›çš„ PTQ æ–¹æ³•çš„ç»“æ„ï¼Œå³é€å±‚è¿›è¡Œé‡åŒ–ï¼Œå¹¶ä¸ºæ¯ä¸€å±‚è§£å†³ç›¸åº”çš„é‡æ„é—®é¢˜ã€‚å…·ä½“è€Œè¨€ï¼Œè®¾ $W_{\ell}$ ä¸ºä¸çº¿æ€§å±‚ $\ell$ å¯¹åº”çš„æƒé‡ï¼Œè®¾ $X_{\ell}$ è¡¨ç¤ºå¯¹åº”äºç»è¿‡ç½‘ç»œçš„ä¸€å°éƒ¨åˆ† $m$ ä¸ªæ•°æ®ç‚¹çš„å±‚è¾“å…¥ã€‚ç„¶åï¼Œç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªé‡åŒ–æƒé‡çŸ©é˜µ $\widehat{W}$ ï¼Œå®ƒèƒ½ä½¿ç›¸å¯¹äºå…¨ç²¾åº¦å±‚è¾“å‡ºçš„å‡æ–¹è¯¯å·®æœ€å°åŒ–ã€‚æ­£å¼åœ°ï¼Œè¿™å¯ä»¥é‡æ–°è¡¨è¿°ä¸º</p>
\[argmin_{\widehat W}\left\| {WX - \widehat WX} \right\|_2^2\]<p>æ­¤å¤–ï¼Œä¸ä¹‹å‰çš„ç ”ç©¶ç±»ä¼¼ï¼Œå›¢é˜Ÿå‡è®¾ $W_{\ell}$ çš„é‡åŒ–ç½‘æ ¼åœ¨è¯¥è¿‡ç¨‹å¼€å§‹ä¹‹å‰å°±å·²å›ºå®šï¼Œå¹¶ä¸”å„ä¸ªæƒé‡å¯ä»¥åƒæ‰€æè¿°çš„é‚£æ ·è‡ªç”±å˜åŠ¨ã€‚</p>
<h2 id="optimal-brain-quantization">Optimal Brain Quantization.</h2>
<p>å›¢é˜Ÿçš„æ–¹æ³•åŸºäºæœ€è¿‘æå‡ºçš„ OBQ æ–¹æ³•æ¥è§£å†³ä¸Šè¿°å®šä¹‰çš„é€å±‚é‡åŒ–é—®é¢˜ï¼Œå›¢é˜Ÿå¯¹è¯¥æ–¹æ³•è¿›è¡Œäº†ä¸€ç³»åˆ—é‡å¤§æ”¹è¿›ï¼Œä½¿å…¶èƒ½å¤Ÿåº”ç”¨äºå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œå¹¶å®ç°è¶…è¿‡ä¸‰ä¸ªæ•°é‡çº§çš„è®¡ç®—é€Ÿåº¦æå‡ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œå›¢é˜Ÿé¦–å…ˆç®€è¦æ€»ç»“ä¸€ä¸‹åŸå§‹çš„ OBQ æ–¹æ³•ã€‚</p>
<p>OBQ æ–¹æ³•åŸºäºè¿™æ ·ä¸€ä¸ªè§‚å¯Ÿç»“æœï¼Œå³å…¬å¼ï¼ˆ1ï¼‰å¯ä»¥å†™æˆçŸ©é˜µ $W$ æ¯ä¸€è¡Œä¸Šçš„å‡æ–¹è¯¯å·®ä¹‹å’Œã€‚ç„¶åï¼ŒOBQ ç‹¬ç«‹å¤„ç†æ¯ä¸€è¡Œ $w$ ï¼Œæ¯æ¬¡å¯¹ä¸€ä¸ªæƒé‡è¿›è¡Œé‡åŒ–ï¼ŒåŒæ—¶å§‹ç»ˆæ›´æ–°æ‰€æœ‰å°šæœªé‡åŒ–çš„æƒé‡ï¼Œä»¥ä¾¿è¡¥å¿å¯¹å•ä¸ªæƒé‡è¿›è¡Œé‡åŒ–æ‰€äº§ç”Ÿçš„è¯¯å·®ã€‚ç”±äºç›¸åº”çš„ç›®æ ‡å‡½æ•°æ˜¯ä¸€ä¸ªäºŒæ¬¡å‡½æ•°ï¼Œå…¶ Hessian çŸ©é˜µä¸º $H_F = 2X_F X_F^T$ ï¼Œå…¶ä¸­ $F$ è¡¨ç¤ºå‰©ä½™å…¨ç²¾åº¦æƒé‡çš„é›†åˆï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¦é‡åŒ–çš„è´ªå©ªæœ€ä¼˜æƒé‡ï¼ˆå›¢é˜Ÿç”¨ $w_q$ è¡¨ç¤ºï¼‰ï¼Œä»¥åŠ $F$ ä¸­æ‰€æœ‰æƒé‡çš„ç›¸åº”æœ€ä¼˜æ›´æ–°é‡ï¼ˆç”¨ $\delta_F$ è¡¨ç¤ºï¼‰ç”±ä»¥ä¸‹å…¬å¼ç»™å‡ºï¼Œå…¶ä¸­ $\text{quant}(w)$ å°† $w$ èˆå…¥åˆ°é‡åŒ–ç½‘æ ¼ä¸Šæœ€æ¥è¿‘çš„å€¼ï¼š</p>
\[{w_q} = argmin_{{w_q}} = \frac{{{{\left( {quant\left( {{w_q}} \right) - {w_q}} \right)}^2}}}{{{{\left[ {H_F^{ - 1}} \right]}_{qq}}}}\]\[{\delta _F} =  - \frac{{{w_q} - quant\left( {{w_q}} \right)}}{{{{\left[ {H_F^{ - 1}} \right]}_{qq}}}} \cdot {\left( {H_F^{ - 1}} \right)_{:,q}}\]<p>OBQ ä½¿ç”¨è¿™ä¸¤ä¸ªå…¬å¼è¿­ä»£åœ°å¯¹æƒé‡è¿›è¡Œé‡åŒ–ï¼Œç›´åˆ° $w$ çš„æ‰€æœ‰æƒé‡éƒ½è¢«é‡åŒ–ã€‚è¿™ç§é‡åŒ–æ–¹å¼æ•ˆç‡å¾ˆé«˜ï¼Œé€šè¿‡ç›´æ¥åœ¨é€†çŸ©é˜µä¸­åˆ©ç”¨ä¸€æ­¥é«˜æ–¯æ¶ˆå…ƒæ³•å»é™¤ $H$ çš„ç¬¬ $q$ è¡Œå’Œç¬¬ $q$ åˆ—ï¼ˆåœ¨å¯¹ $w_q$ è¿›è¡Œé‡åŒ–åè¿™æ˜¯å¿…è¦çš„æ“ä½œï¼‰ï¼Œä»è€Œé¿å…äº†å¯¹ $H^{-1}$ è¿›è¡Œä»£ä»·é«˜æ˜‚çš„å®Œå…¨é‡æ–°è®¡ç®—ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ›´æ–°åçš„é€†çŸ©é˜µç”±ä»¥ä¸‹å…¬å¼ç»™å‡ºï¼š</p>
\[H_{ - q}^{ - 1} = {\left( {{H^{ - 1}} - \frac{1}{{{{\left[ {{H^{ - 1}}} \right]}_{qq}}}}H_{:,q}^{ - 1}H_{q,:}^{ - 1}} \right)_{ - p}}\]<p>è¿™ç§æ–¹æ³•æœ‰ä¸€ä¸ªå‘é‡åŒ–çš„å®ç°æ–¹å¼ï¼Œå¯ä»¥å¹¶è¡Œå¤„ç†çŸ©é˜µ $W$ çš„å¤šè¡Œã€‚æœ€ç»ˆï¼Œè¯¥ç®—æ³•åœ¨ä¸­ç­‰è§„æ¨¡çš„æ¨¡å‹ä¸Šèƒ½å¤Ÿå®ç°è¾ƒä¸ºåˆç†çš„è¿è¡Œæ—¶é—´ï¼šä¾‹å¦‚ï¼Œåœ¨å•ä¸ªGPUä¸Šï¼Œå®ƒèƒ½å¤Ÿåœ¨å¤§çº¦1å°æ—¶å†…å¯¹ ResNet-50 æ¨¡å‹ï¼ˆ2500ä¸‡ä¸ªå‚æ•°ï¼‰è¿›è¡Œå®Œå…¨é‡åŒ–ï¼Œè¿™ä¸å…¶ä»–èƒ½è¾¾åˆ°å½“å‰æœ€ä¼˜ç²¾åº¦çš„è®­ç»ƒåé‡åŒ–æ–¹æ³•å¤§è‡´ç›¸å½“ï¼ˆå¼—å…°å¡”å°”ç­‰äººï¼Œ2022å¹´ï¼‰ã€‚ç„¶è€Œï¼Œå¯¹äºä¸€ä¸ª $d_{row}Â·d_{col}$ çš„çŸ©é˜µ $W$ ï¼ŒOBQ çš„è¿è¡Œæ—¶é—´ä¸è¾“å…¥å‘ˆä¸‰æ¬¡æ–¹å…³ç³»ï¼Œä¸º $O(d_{row} Â· d^3_{col})$ï¼Œè¿™æ„å‘³ç€å°†å…¶åº”ç”¨äºæ‹¥æœ‰æ•°åäº¿å‚æ•°çš„æ¨¡å‹æ—¶ï¼Œè®¡ç®—æˆæœ¬æé«˜ã€‚</p>
<h1 id="gptq-algorithm">GPTQ ALGORITHM</h1>
<h2 id="step-1-arbitrary-order-insight">Step 1: Arbitrary Order Insight.</h2>
<p>å¦‚å‰ä¸€èŠ‚æ‰€è¿°ï¼Œ$OBQ$ æŒ‰ç…§è´ªå©ªé¡ºåºå¯¹æƒé‡è¿›è¡Œé‡åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ€»æ˜¯é€‰æ‹©å½“å‰äº§ç”Ÿé¢å¤–é‡åŒ–è¯¯å·®æœ€å°çš„æƒé‡ã€‚æœ‰è¶£çš„æ˜¯ï¼Œå›¢é˜Ÿå‘ç°ï¼Œè™½ç„¶è¿™ç§ç›¸å½“è‡ªç„¶çš„ç­–ç•¥ç¡®å®ä¼¼ä¹è¡¨ç°å¾—éå¸¸å¥½ï¼Œä½†ä¸ä»¥ä»»æ„é¡ºåºå¯¹æƒé‡è¿›è¡Œé‡åŒ–ç›¸æ¯”ï¼Œå®ƒçš„æå‡é€šå¸¸å¾ˆå°ï¼Œå°¤å…¶æ˜¯åœ¨å‚æ•°ä¼—å¤šçš„å¤§å‹å±‚ä¸Šã€‚æœ€æœ‰å¯èƒ½çš„åŸå› æ˜¯ï¼Œé‚£äº›å•ä¸ªè¯¯å·®è¾ƒå¤§ä½†è¢«é‡åŒ–çš„æƒé‡æ•°é‡ç•¥å°‘ï¼Œè¿™è¢«åœ¨é‡åŒ–è¿‡ç¨‹æ¥è¿‘å°¾å£°æ—¶æ‰è¢«é‡åŒ–çš„è¿™äº›æƒé‡æ‰€æŠµæ¶ˆï¼Œå› ä¸ºåœ¨é‚£ä¸ªæ—¶å€™ï¼Œå‡ ä¹æ²¡æœ‰å…¶ä»–æœªè¢«é‡åŒ–çš„æƒé‡å¯ç”¨äºè°ƒæ•´ä»¥è¿›è¡Œè¡¥å¿äº†ã€‚æ­£å¦‚å›¢é˜Ÿç°åœ¨å°†è¦è®¨è®ºçš„ï¼Œä»»ä½•å›ºå®šçš„é¡ºåºéƒ½å¯èƒ½è¡¨ç°è‰¯å¥½ï¼ˆå°¤å…¶æ˜¯åœ¨å¤§å‹æ¨¡å‹ä¸Šï¼‰è¿™ä¸€è§è§£æœ‰ç€æœ‰è¶£çš„å½±å“ã€‚</p>
<p>åŸå§‹çš„ <em>OBQ</em> æ–¹æ³•æŒ‰ç…§ç”±ç›¸åº”è¯¯å·®æ‰€å®šä¹‰çš„ç‰¹å®šé¡ºåºï¼Œç‹¬ç«‹åœ°å¯¹çŸ©é˜µ $W$ çš„è¡Œè¿›è¡Œé‡åŒ–ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå›¢é˜Ÿçš„ç›®æ ‡æ˜¯ä»¥ç›¸åŒçš„é¡ºåºå¯¹æ‰€æœ‰è¡Œçš„æƒé‡è¿›è¡Œé‡åŒ–ï¼Œå¹¶ä¸”å°†è¯æ˜è¿™æ ·åšé€šå¸¸ä¼šå¾—åˆ°æœ€ç»ˆå‡æ–¹è¯¯å·®ä¸åŸå§‹è§£å†³æ–¹æ¡ˆç›¸ä¼¼çš„ç»“æœã€‚å› æ­¤ï¼Œå¯¹äºæ‰€æœ‰è¡Œè€Œè¨€ï¼Œæœªé‡åŒ–æƒé‡çš„é›†åˆ $F$ ä»¥åŠç±»ä¼¼çš„ $H^{-1}_F$ å§‹ç»ˆæ˜¯ç›¸åŒçš„ï¼ˆç¤ºæ„å›¾è§å›¾ 2ï¼‰ã€‚æ›´è¯¦ç»†åœ°è¯´ï¼Œè¿™æ˜¯å› ä¸º $H_F$ ä»…å–å†³äºå±‚è¾“å…¥ $X_F$ ï¼ˆå¯¹äºæ‰€æœ‰è¡Œæ¥è¯´ $X_F$ éƒ½æ˜¯ç›¸åŒçš„ï¼‰ï¼Œè€Œä¸å–å†³äºä»»ä½•æƒé‡ã€‚æ‰€ä»¥ï¼Œå›¢é˜Ÿåªéœ€æŒ‰ç…§å…¬å¼(3)å¯¹ $H^{-1}_F$ è¿›è¡Œ $d_{col}$ æ¬¡æ›´æ–°ï¼ˆæ¯åˆ—æ›´æ–°ä¸€æ¬¡ï¼‰ï¼Œè€Œä¸æ˜¯ $d_{row}Â·d_{col}$ æ¬¡ï¼ˆæ¯ä¸ªæƒé‡æ›´æ–°ä¸€æ¬¡ï¼‰ã€‚è¿™å°†æ€»ä½“è¿è¡Œæ—¶é—´ä» $O(d_{row} Â· d^3_{col})$ é™ä½åˆ° $O(max\{d_{row} Â· d^2_{col},d^3_{col}\})$ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¿è¡Œæ—¶é—´å‡å°‘äº†$min\{d_{row}, d_{col}\}$ å€ã€‚å¯¹äºæ›´å¤§çš„æ¨¡å‹è€Œè¨€ï¼Œè¿™ç§å·®å¼‚å¯è¾¾å‡ ä¸ªæ•°é‡çº§ã€‚ç„¶è€Œï¼Œåœ¨è¯¥ç®—æ³•çœŸæ­£èƒ½å¤Ÿå®é™…åº”ç”¨äºéå¸¸å¤§çš„æ¨¡å‹ä¹‹å‰ï¼Œè¿˜éœ€è¦è§£å†³å¦å¤–ä¸¤ä¸ªä¸»è¦é—®é¢˜ã€‚
<div class="embed-pdf-container" id="embed-pdf-container-29d60025">
    <div class="pdf-loadingWrapper" id="pdf-loadingWrapper-29d60025">
        <div class="pdf-loading" id="pdf-loading-29d60025"></div>
    </div>
    <div id="overlayText">
      <a href="./fig1.pdf" aria-label="Download" download>
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18">
            <path d="M9 13c.3 0 .5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z" />
        </svg>
      </a>
    </div>
    <canvas class="pdf-canvas" id="pdf-canvas-29d60025"></canvas>
</div>

<div class="pdf-paginator" id="pdf-paginator-29d60025">
    <button id="pdf-prev-29d60025">Previous</button>
    <button id="pdf-next-29d60025">Next</button> &nbsp; &nbsp;
    <span>
      <span class="pdf-pagenum" id="pdf-pagenum-29d60025"></span> / <span class="pdf-pagecount" id="pdf-pagecount-29d60025"></span>
    </span>
    <a class="pdf-source" id="pdf-source-29d60025" href="./fig1.pdf">[pdf]</a>
</div>

<noscript>
View the PDF file <a class="pdf-source" id="pdf-source-noscript-29d60025" href="./fig1.pdf">here</a>.
</noscript>

<script type="text/javascript">
    (function(){
    var url = '.\/fig1.pdf';

    var hidePaginator = "" === "true";
    var hideLoader = "" === "true";
    var selectedPageNum = parseInt("") || 1;


    var showSource = "" === "true";
    var pageSource = document.getElementById("pdf-source-29d60025");

    
    function showSourcef() {
        if(showSource) {
            pageSource.style.display = 'inline';
        } else {
            pageSource.style.display = 'none';
        }
    }

    
    showSourcef();


    
    var pdfjsLib = window['pdfjs-dist/build/pdf'];

    
    if (pdfjsLib.GlobalWorkerOptions.workerSrc == '')
      pdfjsLib.GlobalWorkerOptions.workerSrc = "http:\/\/localhost:1313\/" + 'js/pdf-js/build/pdf.worker.js';

    
    var pdfDoc = null,
        pageNum = selectedPageNum,
        pageRendering = false,
        pageNumPending = null,
        scale = 3,
        canvas = document.getElementById('pdf-canvas-29d60025'),
        ctx = canvas.getContext('2d'),
        paginator = document.getElementById("pdf-paginator-29d60025"),
        loadingWrapper = document.getElementById('pdf-loadingWrapper-29d60025');


    
    showPaginator();
    showLoader();

    

    function renderPage(num) {
      pageRendering = true;
      
      pdfDoc.getPage(num).then(function(page) {
        var viewport = page.getViewport({scale: scale});
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        
        var renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        var renderTask = page.render(renderContext);

        
        renderTask.promise.then(function() {
          pageRendering = false;
          showContent();

          if (pageNumPending !== null) {
            
            renderPage(pageNumPending);
            pageNumPending = null;
          }
        });
      });

      
      document.getElementById('pdf-pagenum-29d60025').textContent = num;
    }

    

    function showContent() {
      loadingWrapper.style.display = 'none';
      canvas.style.display = 'block';
    }

    

    function showLoader() {
      if(hideLoader) return
      loadingWrapper.style.display = 'flex';
      canvas.style.display = 'none';
    }

    

    function showPaginator() {
      if(hidePaginator) return
      paginator.style.display = 'block';
    }

    

    function queueRenderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
      } else {
        renderPage(num);
      }
    }

    

    function onPrevPage() {
      if (pageNum <= 1) {
        return;
      }
      pageNum--;
      queueRenderPage(pageNum);
    }
    document.getElementById('pdf-prev-29d60025').addEventListener('click', onPrevPage);

    

    function onNextPage() {
      if (pageNum >= pdfDoc.numPages) {
        return;
      }
      pageNum++;
      queueRenderPage(pageNum);
    }
    document.getElementById('pdf-next-29d60025').addEventListener('click', onNextPage);

    

    pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
      pdfDoc = pdfDoc_;
      var numPages = pdfDoc.numPages;
      document.getElementById('pdf-pagecount-29d60025').textContent = numPages;

      
      if(pageNum > numPages) {
        pageNum = numPages
      }

      
      renderPage(pageNum);
    });
    })();
</script>
</p>
<h2 id="step-2-lazy-batch-updates">Step 2: Lazy Batch-Updates.</h2>
<p>é¦–å…ˆï¼Œç›´æ¥å®ç°å‰é¢æ‰€æè¿°çš„æ–¹æ¡ˆåœ¨å®é™…ä¸­å¹¶ä¸ä¼šå¾ˆå¿«ï¼Œå› ä¸ºè¯¥ç®—æ³•çš„è®¡ç®—ä¸å†…å­˜è®¿é—®æ¯”ç‡ç›¸å¯¹è¾ƒä½ã€‚ä¾‹å¦‚ï¼Œå…¬å¼ï¼ˆ3ï¼‰éœ€è¦ä»…ç”¨æ¯ä¸ªå…ƒç´ çš„å°‘é‡æµ®ç‚¹è¿ç®—ï¼ˆFLOPsï¼‰æ¥æ›´æ–°ä¸€ä¸ªå¯èƒ½éå¸¸åºå¤§çš„çŸ©é˜µçš„æ‰€æœ‰å…ƒç´ ã€‚è¿™æ ·çš„æ“ä½œæ— æ³•å……åˆ†åˆ©ç”¨ç°ä»£å›¾å½¢å¤„ç†å™¨ï¼ˆGPUï¼‰çš„å¼ºå¤§è®¡ç®—èƒ½åŠ›ï¼Œå¹¶ä¸”ä¼šå—åˆ°ä½å¾—å¤šçš„å†…å­˜å¸¦å®½çš„é™åˆ¶ï¼Œä»è€Œæˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œè¿™ä¸ªé—®é¢˜å¯ä»¥é€šè¿‡ä»¥ä¸‹è§‚å¯Ÿæ¥è§£å†³ï¼šå¯¹äºç¬¬ $i$ åˆ—çš„æœ€ç»ˆå–æ•´å†³ç­–ä»…å—å¯¹è¯¥åˆ—æ‰€æ‰§è¡Œçš„æ›´æ–°æ“ä½œçš„å½±å“ï¼Œå› æ­¤åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­çš„è¿™ä¸€æ—¶åˆ»ï¼Œå¯¹åç»­åˆ—çš„æ›´æ–°æ˜¯æ— å…³ç´§è¦çš„ã€‚è¿™ä½¿å¾—â€œå»¶è¿Ÿæ‰¹é‡å¤„ç†â€æ›´æ–°æ“ä½œæˆä¸ºå¯èƒ½ï¼Œä»è€Œå®ç°æ›´å¥½çš„GPUåˆ©ç”¨ç‡ã€‚å…·ä½“æ¥è¯´ï¼Œå›¢é˜Ÿä¸€æ¬¡å°†è¯¥ç®—æ³•åº”ç”¨äº $B = 128$ åˆ—ï¼Œå°†æ›´æ–°æ“ä½œé™åˆ¶åœ¨è¿™äº›åˆ—ä»¥åŠç›¸åº”çš„ $H^{-1}$ çš„ $BÃ—B$ å­å—ä¸Šï¼ˆå¦è§å›¾2ï¼‰ã€‚åªæœ‰åœ¨ä¸€ä¸ªå­å—è¢«å®Œå…¨å¤„ç†åï¼Œå›¢é˜Ÿæ‰ä¼šä½¿ç”¨ä¸‹é¢ç»™å‡ºçš„å…¬å¼(2)å’Œå…¬å¼(3)çš„å¤šæƒé‡ç‰ˆæœ¬æ¥å¯¹æ•´ä¸ª $H^{-1}$ å’Œ $W$ çŸ©é˜µæ‰§è¡Œå…¨å±€æ›´æ–°ï¼Œå…¶ä¸­ $Q$ è¡¨ç¤ºä¸€ç»„ç´¢å¼•ï¼Œ$H^{-1}_{-Q}$ è¡¨ç¤ºå»æ‰äº†ç›¸åº”è¡Œå’Œåˆ—çš„é€†çŸ©é˜µï¼š</p>
\[{\delta _F} =  - \left( {{W_Q} - quant\left( {WQ} \right)} \right){\left( {{{\left[ {H_F^{ - 1}} \right]}_{QQ}}} \right)^{ - 1}}{\left( {H_F^{ - 1}} \right)_{:,Q}}\]\[H_{ - Q}^{ - 1} = {\left( {{H^{ - 1}} - H_{:,Q}^{ - 1}{{\left( {{{\left[ {{H^{ - 1}}} \right]}_{QQ}}} \right)}^{ - 1}}H_{Q,:}^{ - 1}} \right)_{ - Q}}\]<p>å°½ç®¡è¿™ç§ç­–ç•¥å¹¶æœªå‡å°‘ç†è®ºä¸Šçš„è®¡ç®—é‡ï¼Œä½†å®ƒæœ‰æ•ˆåœ°è§£å†³äº†å†…å­˜ååé‡ç“¶é¢ˆé—®é¢˜ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™ä¸ºéå¸¸å¤§çš„æ¨¡å‹å¸¦æ¥äº†ä¸€ä¸ªæ•°é‡çº§çš„é€Ÿåº¦æå‡ï¼Œä½¿å…¶æˆä¸ºå›¢é˜Ÿç®—æ³•çš„ä¸€ä¸ªå…³é”®ç»„æˆéƒ¨åˆ†ã€‚</p>
<h2 id="step-3-cholesky-reformulation">Step 3: Cholesky Reformulation.</h2>
<p>å›¢é˜Ÿå¿…é¡»è§£å†³çš„æœ€åä¸€ä¸ªæŠ€æœ¯é—®é¢˜æ˜¯ç”±æ•°å€¼ä¸ç²¾ç¡®æ€§å¯¼è‡´çš„ï¼Œåœ¨ç°æœ‰æ¨¡å‹çš„è§„æ¨¡ä¸‹ï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºä¸€ä¸ªä¸»è¦é—®é¢˜ï¼Œå°¤å…¶æ˜¯å½“ä¸ä¸Šä¸€æ­¥ä¸­è®¨è®ºçš„åˆ†å—æ›´æ–°ç»“åˆèµ·æ¥æ—¶ã€‚å…·ä½“è€Œè¨€ï¼Œå¯èƒ½ä¼šå‡ºç°çŸ©é˜µ $H^{-1}_F$ å˜ä¸ºä¸å®šçŸ©é˜µçš„æƒ…å†µï¼Œå›¢é˜Ÿæ³¨æ„åˆ°è¿™å¯èƒ½ä¼šå¯¼è‡´ç®—æ³•æœç€é”™è¯¯çš„æ–¹å‘å¤§å¹…æ›´æ–°å‰©ä½™çš„æƒé‡ï¼Œä»è€Œå¯¼è‡´ç›¸åº”å±‚çš„é‡åŒ–ç»“æœæå…¶ç³Ÿç³•ã€‚åœ¨å®é™…ä¸­ï¼Œå›¢é˜Ÿè§‚å¯Ÿåˆ°è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡ä¼šéšç€æ¨¡å‹è§„æ¨¡çš„å¢å¤§è€Œå¢åŠ ï¼šå…·ä½“æ¥è¯´ï¼Œå¯¹äºå‚æ•°è¶…è¿‡å‡ åäº¿çš„æ¨¡å‹ï¼Œå‡ ä¹å¯ä»¥è‚¯å®šè‡³å°‘æœ‰å‡ å±‚ä¼šå‡ºç°è¿™ç§æƒ…å†µã€‚ä¸»è¦é—®é¢˜ä¼¼ä¹åœ¨äºå…¬å¼(5)çš„é‡å¤åº”ç”¨ï¼Œè¿™ä¼šç´¯ç§¯å„ç§æ•°å€¼è¯¯å·®ï¼Œå°¤å…¶æ˜¯é€šè¿‡é¢å¤–çš„çŸ©é˜µæ±‚é€†æ“ä½œã€‚</p>
<p>å¯¹äºè¾ƒå°çš„æ¨¡å‹ï¼Œåº”ç”¨é˜»å°¼æ–¹æ³•ï¼Œå³åœ¨çŸ©é˜µ $H$ çš„å¯¹è§’å…ƒç´ ä¸ŠåŠ ä¸Šä¸€ä¸ªå°çš„å¸¸æ•° $\lambda$ï¼ˆå›¢é˜Ÿé€šå¸¸é€‰æ‹©å¹³å‡å¯¹è§’å€¼çš„$1\%$ï¼‰ï¼Œä¼¼ä¹è¶³ä»¥é¿å…æ•°å€¼é—®é¢˜ã€‚ç„¶è€Œï¼Œå¯¹äºè¾ƒå¤§çš„æ¨¡å‹ï¼Œåˆ™éœ€è¦ä¸€ç§æ›´å¯é ã€æ›´é€šç”¨çš„æ–¹æ³•ã€‚</p>
<p>ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå›¢é˜Ÿé¦–å…ˆæ³¨æ„åˆ°ï¼Œå½“å¯¹æƒé‡ $q$ è¿›è¡Œé‡åŒ–æ—¶ï¼Œä» $H^{-1}_{F_{q}}$ï¼ˆå…¶ä¸­ $F_{q}$ è¡¨ç¤ºæœªé‡åŒ–æƒé‡çš„é›†åˆï¼‰ä¸­æ‰€éœ€çš„å”¯ä¸€ä¿¡æ¯æ˜¯ç¬¬ $q$ è¡Œï¼Œæˆ–è€…æ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯ä»å¯¹è§’å…ƒç´ å¼€å§‹çš„è¯¥è¡Œä¸­çš„å…ƒç´ ã€‚å…¶ç»“æœæ˜¯ï¼Œå›¢é˜Ÿå¯ä»¥ä½¿ç”¨ä¸€ç§æ•°å€¼ä¸Šæ›´ç¨³å®šçš„æ–¹æ³•é¢„å…ˆè®¡ç®—å‡ºæ‰€æœ‰è¿™äº›è¡Œï¼Œè€Œä¸ä¼šæ˜¾è‘—å¢åŠ å†…å­˜æ¶ˆè€—ã€‚å®é™…ä¸Šï¼Œå¯¹äºå›¢é˜Ÿçš„å¯¹ç§°çŸ©é˜µ $H^{-1}$ï¼Œé€šè¿‡å…¬å¼(3)è¿›è¡Œçš„è¡Œåˆ é™¤æ“ä½œåœ¨æœ¬è´¨ä¸Šå¯¹åº”äºè¿›è¡Œä¹”åˆ—æ–¯åŸºåˆ†è§£ï¼Œåªæ˜¯æœ‰ä¸€ä¸ªç»†å¾®çš„å·®åˆ«ï¼Œå³ä¹”åˆ—æ–¯åŸºåˆ†è§£ä¼šå°†ç¬¬ $q$ è¡Œé™¤ä»¥ $([H^{-1}_{F_{q}}]_{qq})^{\frac{1}{2}}$ ã€‚å› æ­¤ï¼Œå›¢é˜Ÿå¯ä»¥åˆ©ç”¨æœ€å…ˆè¿›çš„ä¹”åˆ—æ–¯åŸºåˆ†è§£å†…æ ¸æ¥é¢„å…ˆè®¡ç®—å‡ºå›¢é˜Ÿå°†ä» $H^{-1}$ ä¸­æ‰€éœ€çš„æ‰€æœ‰ä¿¡æ¯ã€‚ç»“åˆé€‚åº¦çš„é˜»å°¼å¤„ç†ï¼Œæœ€ç»ˆå¾—åˆ°çš„æ–¹æ³•è¶³å¤Ÿç¨³å¥ï¼Œèƒ½å¤Ÿåœ¨å¤§å‹æ¨¡å‹ä¸Šé¡ºåˆ©æ‰§è¡Œè€Œä¸å‡ºé—®é¢˜ã€‚é¢å¤–çš„å¥½å¤„æ˜¯ï¼Œä½¿ç”¨ç»è¿‡è‰¯å¥½ä¼˜åŒ–çš„ä¹”åˆ—æ–¯åŸºå†…æ ¸è¿˜èƒ½è¿›ä¸€æ­¥æå‡é€Ÿåº¦ã€‚æ¥ä¸‹æ¥ï¼Œå›¢é˜Ÿå°†è¯¦ç»†è¯´æ˜è¯¥ç®—æ³•çš„ä¹”åˆ—æ–¯åŸºç‰ˆæœ¬æ‰€éœ€çš„æ‰€æœ‰ç»†å¾®æ”¹åŠ¨ã€‚</p>
<p>æœ€åï¼Œå›¢é˜Ÿåœ¨ç®—æ³• 1 ä¸­ç»™å‡ºäº† GPTQ çš„å®Œæ•´ä¼ªä»£ç ï¼Œå…¶ä¸­åŒ…æ‹¬äº†ä¸Šè¿°æ‰€è®¨è®ºçš„ä¼˜åŒ–å†…å®¹ã€‚
<div class="embed-pdf-container" id="embed-pdf-container-1cfcaf78">
    <div class="pdf-loadingWrapper" id="pdf-loadingWrapper-1cfcaf78">
        <div class="pdf-loading" id="pdf-loading-1cfcaf78"></div>
    </div>
    <div id="overlayText">
      <a href="./fig2.pdf" aria-label="Download" download>
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18">
            <path d="M9 13c.3 0 .5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z" />
        </svg>
      </a>
    </div>
    <canvas class="pdf-canvas" id="pdf-canvas-1cfcaf78"></canvas>
</div>

<div class="pdf-paginator" id="pdf-paginator-1cfcaf78">
    <button id="pdf-prev-1cfcaf78">Previous</button>
    <button id="pdf-next-1cfcaf78">Next</button> &nbsp; &nbsp;
    <span>
      <span class="pdf-pagenum" id="pdf-pagenum-1cfcaf78"></span> / <span class="pdf-pagecount" id="pdf-pagecount-1cfcaf78"></span>
    </span>
    <a class="pdf-source" id="pdf-source-1cfcaf78" href="./fig2.pdf">[pdf]</a>
</div>

<noscript>
View the PDF file <a class="pdf-source" id="pdf-source-noscript-1cfcaf78" href="./fig2.pdf">here</a>.
</noscript>

<script type="text/javascript">
    (function(){
    var url = '.\/fig2.pdf';

    var hidePaginator = "" === "true";
    var hideLoader = "" === "true";
    var selectedPageNum = parseInt("") || 1;


    var showSource = "" === "true";
    var pageSource = document.getElementById("pdf-source-1cfcaf78");

    
    function showSourcef() {
        if(showSource) {
            pageSource.style.display = 'inline';
        } else {
            pageSource.style.display = 'none';
        }
    }

    
    showSourcef();


    
    var pdfjsLib = window['pdfjs-dist/build/pdf'];

    
    if (pdfjsLib.GlobalWorkerOptions.workerSrc == '')
      pdfjsLib.GlobalWorkerOptions.workerSrc = "http:\/\/localhost:1313\/" + 'js/pdf-js/build/pdf.worker.js';

    
    var pdfDoc = null,
        pageNum = selectedPageNum,
        pageRendering = false,
        pageNumPending = null,
        scale = 3,
        canvas = document.getElementById('pdf-canvas-1cfcaf78'),
        ctx = canvas.getContext('2d'),
        paginator = document.getElementById("pdf-paginator-1cfcaf78"),
        loadingWrapper = document.getElementById('pdf-loadingWrapper-1cfcaf78');


    
    showPaginator();
    showLoader();

    

    function renderPage(num) {
      pageRendering = true;
      
      pdfDoc.getPage(num).then(function(page) {
        var viewport = page.getViewport({scale: scale});
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        
        var renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        var renderTask = page.render(renderContext);

        
        renderTask.promise.then(function() {
          pageRendering = false;
          showContent();

          if (pageNumPending !== null) {
            
            renderPage(pageNumPending);
            pageNumPending = null;
          }
        });
      });

      
      document.getElementById('pdf-pagenum-1cfcaf78').textContent = num;
    }

    

    function showContent() {
      loadingWrapper.style.display = 'none';
      canvas.style.display = 'block';
    }

    

    function showLoader() {
      if(hideLoader) return
      loadingWrapper.style.display = 'flex';
      canvas.style.display = 'none';
    }

    

    function showPaginator() {
      if(hidePaginator) return
      paginator.style.display = 'block';
    }

    

    function queueRenderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
      } else {
        renderPage(num);
      }
    }

    

    function onPrevPage() {
      if (pageNum <= 1) {
        return;
      }
      pageNum--;
      queueRenderPage(pageNum);
    }
    document.getElementById('pdf-prev-1cfcaf78').addEventListener('click', onPrevPage);

    

    function onNextPage() {
      if (pageNum >= pdfDoc.numPages) {
        return;
      }
      pageNum++;
      queueRenderPage(pageNum);
    }
    document.getElementById('pdf-next-1cfcaf78').addEventListener('click', onNextPage);

    

    pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
      pdfDoc = pdfDoc_;
      var numPages = pdfDoc.numPages;
      document.getElementById('pdf-pagecount-1cfcaf78').textContent = numPages;

      
      if(pageNum > numPages) {
        pageNum = numPages
      }

      
      renderPage(pageNum);
    });
    })();
</script>
</p>

        
      </section>

      

      
    </article>
  </div>

  <div
    x-data="tocHighlighter()"
    @scroll.window="debouncedScroll"
    class="hidden lg:flex lg:flex-col lg:items-end">
    
      <nav id="TableOfContents">
  <ol>
    <li><a href="#layer-wise-quantization">Layer-Wise Quantization</a></li>
    <li><a href="#optimal-brain-quantization">Optimal Brain Quantization.</a></li>
  </ol>

  <ol>
    <li><a href="#step-1-arbitrary-order-insight">Step 1: Arbitrary Order Insight.</a></li>
    <li><a href="#step-2-lazy-batch-updates">Step 2: Lazy Batch-Updates.</a></li>
    <li><a href="#step-3-cholesky-reformulation">Step 3: Cholesky Reformulation.</a></li>
  </ol>
</nav>
    
  </div>
</div>


            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    Â© 2025 dO.ob&#39;s Blog
  </p>
  

  
  <p class="text-sm">
    ğŸŒ±
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
        <div class="back">
          <div class="container">
            
            <div class="max-w-[65ch] mt-8 mx-auto px-4">
  
  
  
  <div>
    <div class="mb-4 text-lg font-medium">å…³äºæˆ‘</div>

    <div class="prose dark:prose-invert">
      <p>æˆ‘æ˜¯ä¸€åAIä»ä¸šè€…ï¼Œè‡´åŠ›äºäººå·¥æ™ºèƒ½å’Œæ•°æ®é©±åŠ¨è¡Œä¸šã€‚</p>
<p>è¸ä¸Šå–ç»è·¯ï¼Œæ¯”æŠµè¾¾çµå±±æ›´é‡è¦</p>

    </div>
  </div>
  <div class="divider divider-vertical"></div>
  
  

  

  
</div>

            

            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    Â© 2025 dO.ob&#39;s Blog
  </p>
  

  
  <p class="text-sm">
    ğŸŒ±
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
      </div>
    </div>

    <script>
  window.lightTheme = "emerald"
  window.darkTheme = "forest"
</script>





<script src="/js/main.js"></script>

    







<script src="/js/toc.js"></script>





    

    

    

    

    <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js" integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin="anonymous"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js" integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin="anonymous"></script>
  </body>
</html>
