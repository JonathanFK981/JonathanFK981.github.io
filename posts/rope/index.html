<!DOCTYPE html>
<html lang="zh-Hans"
  x-data
  :class="$store.darkMode.class()"
  :data-theme="$store.darkMode.theme()">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoPE | dO.ob&#39;s Blog</title>

    

<link rel="canonical" href="http://localhost:1313/posts/rope/" />



<meta name="author" content="Author Name" />
<meta name="description" content="ä½ç½®ç¼–ç æœ€è¿‘åœ¨Transformeræ¶æ„ä¸­å·²æ˜¾ç¤ºå‡ºæœ‰æ•ˆæ€§ã€‚å®ƒä¸ºå¯¹åºåˆ—ä¸­ä¸åŒä½ç½®çš„å…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡æä¾›äº†æœ‰ä»·å€¼çš„ç›‘ç£ä¿¡æ¯ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç ”ç©¶äº†å°†ä½ç½®ä¿¡æ¯æ•´åˆåˆ°åŸºäºTransformerçš„è¯­è¨€æ¨¡å‹å­¦ä¹ è¿‡ç¨‹ä¸­çš„å„ç§æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åä¸ºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„æ–°æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ä½ç½®ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œæ‰€æå‡ºçš„RoPEä½¿ç”¨æ—‹è½¬çŸ©é˜µå¯¹ç»å¯¹ä½ç½®è¿›è¡Œç¼–ç ï¼ŒåŒæ—¶åœ¨è‡ªæ³¨æ„åŠ›å…¬å¼ä¸­çº³å…¥äº†æ˜ç¡®çš„ç›¸å¯¹ä½ç½®ä¾èµ–å…³ç³»ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRoPEå…·æœ‰ä¸€äº›æœ‰ä»·å€¼çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬åºåˆ—é•¿åº¦çš„çµæ´»æ€§ã€éšç€ç›¸å¯¹è·ç¦»å¢åŠ è€Œè¡°å‡çš„è¯é—´ä¾èµ–å…³ç³»ï¼Œä»¥åŠä¸ºçº¿æ€§è‡ªæ³¨æ„åŠ›é…å¤‡ç›¸å¯¹ä½ç½®ç¼–ç çš„èƒ½åŠ›ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨å„ç§é•¿æ–‡æœ¬åˆ†ç±»åŸºå‡†æ•°æ®é›†ä¸Šå¯¹é‡‡ç”¨äº†æ—‹è½¬ä½ç½®åµŒå…¥çš„å¢å¼ºå‹Transformerï¼ˆä¹Ÿç§°ä¸ºRoFormerï¼‰è¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œå®ƒå§‹ç»ˆä¼˜äºå…¶ä»–æ›¿ä»£æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç†è®ºåˆ†ææ¥è§£é‡Šä¸€äº›å®éªŒç»“æœã€‚RoFormerå·²ç»é›†æˆåˆ°äº†Huggingfaceä¸­ï¼šhttps://huggingface.co/docs/transformers/model_doc/roformer ã€‚
" />


<meta name="keywords" content="Tag1,Tag2">



<meta name="generator" content="Hugo 0.146.2">


<meta property="og:url" content="http://localhost:1313/posts/rope/">
  <meta property="og:site_name" content="dO.ob&#39;s Blog">
  <meta property="og:title" content="RoPE">
  <meta property="og:description" content="ä½ç½®ç¼–ç æœ€è¿‘åœ¨Transformeræ¶æ„ä¸­å·²æ˜¾ç¤ºå‡ºæœ‰æ•ˆæ€§ã€‚å®ƒä¸ºå¯¹åºåˆ—ä¸­ä¸åŒä½ç½®çš„å…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡æä¾›äº†æœ‰ä»·å€¼çš„ç›‘ç£ä¿¡æ¯ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç ”ç©¶äº†å°†ä½ç½®ä¿¡æ¯æ•´åˆåˆ°åŸºäºTransformerçš„è¯­è¨€æ¨¡å‹å­¦ä¹ è¿‡ç¨‹ä¸­çš„å„ç§æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åä¸ºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„æ–°æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ä½ç½®ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œæ‰€æå‡ºçš„RoPEä½¿ç”¨æ—‹è½¬çŸ©é˜µå¯¹ç»å¯¹ä½ç½®è¿›è¡Œç¼–ç ï¼ŒåŒæ—¶åœ¨è‡ªæ³¨æ„åŠ›å…¬å¼ä¸­çº³å…¥äº†æ˜ç¡®çš„ç›¸å¯¹ä½ç½®ä¾èµ–å…³ç³»ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRoPEå…·æœ‰ä¸€äº›æœ‰ä»·å€¼çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬åºåˆ—é•¿åº¦çš„çµæ´»æ€§ã€éšç€ç›¸å¯¹è·ç¦»å¢åŠ è€Œè¡°å‡çš„è¯é—´ä¾èµ–å…³ç³»ï¼Œä»¥åŠä¸ºçº¿æ€§è‡ªæ³¨æ„åŠ›é…å¤‡ç›¸å¯¹ä½ç½®ç¼–ç çš„èƒ½åŠ›ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨å„ç§é•¿æ–‡æœ¬åˆ†ç±»åŸºå‡†æ•°æ®é›†ä¸Šå¯¹é‡‡ç”¨äº†æ—‹è½¬ä½ç½®åµŒå…¥çš„å¢å¼ºå‹Transformerï¼ˆä¹Ÿç§°ä¸ºRoFormerï¼‰è¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œå®ƒå§‹ç»ˆä¼˜äºå…¶ä»–æ›¿ä»£æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç†è®ºåˆ†ææ¥è§£é‡Šä¸€äº›å®éªŒç»“æœã€‚RoFormerå·²ç»é›†æˆåˆ°äº†Huggingfaceä¸­ï¼šhttps://huggingface.co/docs/transformers/model_doc/roformer ã€‚">
  <meta property="og:locale" content="zh_Hans">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-18T17:47:12+08:00">
    <meta property="article:modified_time" content="2025-04-18T17:47:12+08:00">
    <meta property="article:tag" content="Tag1">
    <meta property="article:tag" content="Tag2">




  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="RoPE">
  <meta name="twitter:description" content="ä½ç½®ç¼–ç æœ€è¿‘åœ¨Transformeræ¶æ„ä¸­å·²æ˜¾ç¤ºå‡ºæœ‰æ•ˆæ€§ã€‚å®ƒä¸ºå¯¹åºåˆ—ä¸­ä¸åŒä½ç½®çš„å…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡æä¾›äº†æœ‰ä»·å€¼çš„ç›‘ç£ä¿¡æ¯ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç ”ç©¶äº†å°†ä½ç½®ä¿¡æ¯æ•´åˆåˆ°åŸºäºTransformerçš„è¯­è¨€æ¨¡å‹å­¦ä¹ è¿‡ç¨‹ä¸­çš„å„ç§æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åä¸ºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„æ–°æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ä½ç½®ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œæ‰€æå‡ºçš„RoPEä½¿ç”¨æ—‹è½¬çŸ©é˜µå¯¹ç»å¯¹ä½ç½®è¿›è¡Œç¼–ç ï¼ŒåŒæ—¶åœ¨è‡ªæ³¨æ„åŠ›å…¬å¼ä¸­çº³å…¥äº†æ˜ç¡®çš„ç›¸å¯¹ä½ç½®ä¾èµ–å…³ç³»ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRoPEå…·æœ‰ä¸€äº›æœ‰ä»·å€¼çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬åºåˆ—é•¿åº¦çš„çµæ´»æ€§ã€éšç€ç›¸å¯¹è·ç¦»å¢åŠ è€Œè¡°å‡çš„è¯é—´ä¾èµ–å…³ç³»ï¼Œä»¥åŠä¸ºçº¿æ€§è‡ªæ³¨æ„åŠ›é…å¤‡ç›¸å¯¹ä½ç½®ç¼–ç çš„èƒ½åŠ›ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨å„ç§é•¿æ–‡æœ¬åˆ†ç±»åŸºå‡†æ•°æ®é›†ä¸Šå¯¹é‡‡ç”¨äº†æ—‹è½¬ä½ç½®åµŒå…¥çš„å¢å¼ºå‹Transformerï¼ˆä¹Ÿç§°ä¸ºRoFormerï¼‰è¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œå®ƒå§‹ç»ˆä¼˜äºå…¶ä»–æ›¿ä»£æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç†è®ºåˆ†ææ¥è§£é‡Šä¸€äº›å®éªŒç»“æœã€‚RoFormerå·²ç»é›†æˆåˆ°äº†Huggingfaceä¸­ï¼šhttps://huggingface.co/docs/transformers/model_doc/roformer ã€‚">




<link rel="stylesheet" href="/css/output.css" />




<script>
  MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)']],
      displayMath: [['$$','$$']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 


    
<script>
  MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)'], ['$', '$']],
      displayMath: [['$$', '$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 


    


<style>
  pre {
    padding: 1em;
    overflow: auto;
  }
</style>









    

    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3/dist/cdn.min.js" integrity="sha256-PtHu0lJIiSHfZeNj1nFd6wTX+Squ255SGZ/fc8seCtM=" crossorigin="anonymous"></script>
  </head>

  <body x-data="{
    flip: false,
  }">
    
    <div id="dream-global-bg"></div>

    
<nav class="mt-4 lg:mt-8 py-4">

  
  <div class="container flex justify-between max-w-[65ch] mx-auto px-4 md:px-0">
  
    <section class="flex items-center gap-4">
      <div class="avatar cursor-pointer hover:avatar-online" @click="flip = !flip" title="ç¿»è½¬ä¸€ä¸‹ï¼">
        <div class="h-10 rounded-full">
          <img src="/img/logo.jpg" alt="Jonathan&#39;s Blog" />
        </div>
      </div>

      
      <div>
        
        <a href="http://localhost:1313/" class="text-lg font-semibold cursor-pointer">
          Jonathan&#39;s Blog
        </a>
        
        
      </div>
      
    </section>

    
    

    <div class="dropdown dropdown-end sm:hidden">
      <div tabindex="0" role="button" class="btn btn-ghost btn-square" aria-label="Select an option">
        <ion-icon name="menu" class="text-2xl"></ion-icon>
      </div>
      <ul tabindex="0" class="dropdown-content menu w-36 bg-base-100 rounded-box z-1 shadow-md">
        







<li>
  <div role="link" tabindex="0" class="inline-flex items-center p-2 cursor-pointer" @click="flip = !flip" title="å…³äº">
    <ion-icon name="information-circle"></ion-icon>å…³äº</div>
</li>





















<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/posts" title="å½’æ¡£">
    <ion-icon name="archive"></ion-icon>
    å½’æ¡£
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/categories" title="æ‰€æœ‰åˆ†ç±»">
    <ion-icon name="grid"></ion-icon>
    æ‰€æœ‰åˆ†ç±»
  </a>
</li>




<li>
  <a class="inline-flex items-center p-2 cursor-pointer" href="/tags" title="æ‰€æœ‰æ ‡ç­¾">
    <ion-icon name="pricetags"></ion-icon>
    æ‰€æœ‰æ ‡ç­¾
  </a>
</li>






      </ul>
    </div>
    <section class="hidden sm:flex sm:items-center sm:gap-2 md:gap-4">
      

      
      




<div role="link" tabindex="0" class="text-sm font-semibold cursor-pointer hover:underline" @click="flip = !flip" title="å…³äº">å…³äº</div>





      
      





      
      





      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/posts" title="å½’æ¡£">
  <ion-icon class="group-hover:text-primary-content" name="archive"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/categories" title="æ‰€æœ‰åˆ†ç±»">
  <ion-icon class="group-hover:text-primary-content" name="grid"></ion-icon>
</a>


      
      
<a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary" href="/tags" title="æ‰€æœ‰æ ‡ç­¾">
  <ion-icon class="group-hover:text-primary-content" name="pricetags"></ion-icon>
</a>


      

      

      
    </section>
  </div>
</nav>


    <div class="flip-container" :class="{ 'flip-it': flip }">
      <div class="flipper">
        <div class="front">
          <div class="container">
            
<div class="lg:grid lg:grid-cols-4 gap-4 mt-4 px-4">
  <div class="hidden lg:block">
    
  </div>

  <div class="lg:col-span-2">
    <article class="mx-auto prose prose-quoteless dark:prose-invert" id="dream-single-post-main" itemscope itemtype="http://schema.org/Article">
      
  <meta itemprop="name" content="RoPE">
  <meta itemprop="description" content="ä½ç½®ç¼–ç æœ€è¿‘åœ¨Transformeræ¶æ„ä¸­å·²æ˜¾ç¤ºå‡ºæœ‰æ•ˆæ€§ã€‚å®ƒä¸ºå¯¹åºåˆ—ä¸­ä¸åŒä½ç½®çš„å…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡æä¾›äº†æœ‰ä»·å€¼çš„ç›‘ç£ä¿¡æ¯ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç ”ç©¶äº†å°†ä½ç½®ä¿¡æ¯æ•´åˆåˆ°åŸºäºTransformerçš„è¯­è¨€æ¨¡å‹å­¦ä¹ è¿‡ç¨‹ä¸­çš„å„ç§æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åä¸ºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„æ–°æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ä½ç½®ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œæ‰€æå‡ºçš„RoPEä½¿ç”¨æ—‹è½¬çŸ©é˜µå¯¹ç»å¯¹ä½ç½®è¿›è¡Œç¼–ç ï¼ŒåŒæ—¶åœ¨è‡ªæ³¨æ„åŠ›å…¬å¼ä¸­çº³å…¥äº†æ˜ç¡®çš„ç›¸å¯¹ä½ç½®ä¾èµ–å…³ç³»ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRoPEå…·æœ‰ä¸€äº›æœ‰ä»·å€¼çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬åºåˆ—é•¿åº¦çš„çµæ´»æ€§ã€éšç€ç›¸å¯¹è·ç¦»å¢åŠ è€Œè¡°å‡çš„è¯é—´ä¾èµ–å…³ç³»ï¼Œä»¥åŠä¸ºçº¿æ€§è‡ªæ³¨æ„åŠ›é…å¤‡ç›¸å¯¹ä½ç½®ç¼–ç çš„èƒ½åŠ›ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨å„ç§é•¿æ–‡æœ¬åˆ†ç±»åŸºå‡†æ•°æ®é›†ä¸Šå¯¹é‡‡ç”¨äº†æ—‹è½¬ä½ç½®åµŒå…¥çš„å¢å¼ºå‹Transformerï¼ˆä¹Ÿç§°ä¸ºRoFormerï¼‰è¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œå®ƒå§‹ç»ˆä¼˜äºå…¶ä»–æ›¿ä»£æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç†è®ºåˆ†ææ¥è§£é‡Šä¸€äº›å®éªŒç»“æœã€‚RoFormerå·²ç»é›†æˆåˆ°äº†Huggingfaceä¸­ï¼šhttps://huggingface.co/docs/transformers/model_doc/roformer ã€‚">
  <meta itemprop="datePublished" content="2025-04-18T17:47:12+08:00">
  <meta itemprop="dateModified" content="2025-04-18T17:47:12+08:00">
  <meta itemprop="wordCount" content="885">
  <meta itemprop="keywords" content="Tag1,Tag2">

      <header>
        <h1 itemprop="headline">RoPE</h1>
        <p class="text-sm">
          
            æ˜ŸæœŸäº”, 4æœˆ 18, 2025
          

          | <span>5åˆ†é’Ÿé˜…è¯»</span>

          
          | <span>æ›´æ–°äº
            
              æ˜ŸæœŸäº”, 4æœˆ 18, 2025
            </span>
          
        </p>

        
        <div class="flex justify-between">
          
            <div class="flex items-center">
  
  <span>@</span>
  

  <span itemprop="author" itemscope itemtype="https://schema.org/Person">
  
    
      <span itemprop="name">Author Name</span>
    
  
  </span>
</div>

          

          <div class="flex items-center gap-2">
  
  

  
  
  
  
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://x.com/intent/post?text=RoPE&amp;url=http://localhost:1313/posts/rope/" target="_blank" rel="noopener noreferrer"
      title="Share on X">
      <ion-icon class="group-hover:text-primary-content" name="logo-x"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://facebook.com/sharer/sharer.php?u=http://localhost:1313/posts/rope/" target="_blank" rel="noopener noreferrer"
      title="Share on Facebook">
      <ion-icon class="group-hover:text-primary-content" name="logo-facebook"></ion-icon>
    </a>
  
    <a class="group inline-flex items-center p-2 rounded-full cursor-pointer hover:bg-primary"
      href="https://wa.me/?text=RoPE%20http://localhost:1313/posts/rope/" target="_blank" rel="noopener noreferrer"
      title="Share on WhatsApp">
      <ion-icon class="group-hover:text-primary-content" name="logo-whatsapp"></ion-icon>
    </a>
  

  
  
</div>

        </div>
      </header>

      <section id="dream-single-post-content" itemprop="articleBody">
        
          <img class="w-full z-30" src="/img/a.jpg" alt="RoPE" />
        

        <p>ä½ç½®ç¼–ç æœ€è¿‘åœ¨Transformeræ¶æ„ä¸­å·²æ˜¾ç¤ºå‡ºæœ‰æ•ˆæ€§ã€‚å®ƒä¸ºå¯¹åºåˆ—ä¸­ä¸åŒä½ç½®çš„å…ƒç´ ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡æä¾›äº†æœ‰ä»·å€¼çš„ç›‘ç£ä¿¡æ¯ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆç ”ç©¶äº†å°†ä½ç½®ä¿¡æ¯æ•´åˆåˆ°åŸºäºTransformerçš„è¯­è¨€æ¨¡å‹å­¦ä¹ è¿‡ç¨‹ä¸­çš„å„ç§æ–¹æ³•ã€‚ç„¶åï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ç§åä¸ºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„æ–°æ–¹æ³•ï¼Œä»¥æœ‰æ•ˆåœ°åˆ©ç”¨ä½ç½®ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼Œæ‰€æå‡ºçš„RoPEä½¿ç”¨æ—‹è½¬çŸ©é˜µå¯¹ç»å¯¹ä½ç½®è¿›è¡Œç¼–ç ï¼ŒåŒæ—¶åœ¨è‡ªæ³¨æ„åŠ›å…¬å¼ä¸­çº³å…¥äº†æ˜ç¡®çš„ç›¸å¯¹ä½ç½®ä¾èµ–å…³ç³»ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRoPEå…·æœ‰ä¸€äº›æœ‰ä»·å€¼çš„ç‰¹æ€§ï¼ŒåŒ…æ‹¬åºåˆ—é•¿åº¦çš„çµæ´»æ€§ã€éšç€ç›¸å¯¹è·ç¦»å¢åŠ è€Œè¡°å‡çš„è¯é—´ä¾èµ–å…³ç³»ï¼Œä»¥åŠä¸ºçº¿æ€§è‡ªæ³¨æ„åŠ›é…å¤‡ç›¸å¯¹ä½ç½®ç¼–ç çš„èƒ½åŠ›ã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨å„ç§é•¿æ–‡æœ¬åˆ†ç±»åŸºå‡†æ•°æ®é›†ä¸Šå¯¹é‡‡ç”¨äº†æ—‹è½¬ä½ç½®åµŒå…¥çš„å¢å¼ºå‹Transformerï¼ˆä¹Ÿç§°ä¸ºRoFormerï¼‰è¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œå®ƒå§‹ç»ˆä¼˜äºå…¶ä»–æ›¿ä»£æ–¹æ³•ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç†è®ºåˆ†ææ¥è§£é‡Šä¸€äº›å®éªŒç»“æœã€‚RoFormerå·²ç»é›†æˆåˆ°äº†Huggingfaceä¸­ï¼šhttps://huggingface.co/docs/transformers/model_doc/roformer ã€‚</p>
<p>å•è¯çš„é¡ºåºå¯¹äºè‡ªç„¶è¯­è¨€ç†è§£å…·æœ‰é‡å¤§ä»·å€¼ã€‚åŸºäºå¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNsï¼‰çš„æ¨¡å‹é€šè¿‡æ²¿ç€æ—¶é—´ç»´åº¦é€’å½’åœ°è®¡ç®—éšè—çŠ¶æ€æ¥å¯¹è¯å…ƒçš„é¡ºåºè¿›è¡Œç¼–ç ã€‚åŸºäºå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNsï¼‰çš„æ¨¡å‹ï¼ˆå¦‚Gehringç­‰äººåœ¨2017å¹´çš„ç ”ç©¶æˆæœï¼‰é€šå¸¸è¢«è®¤ä¸ºä¸ä½ç½®æ— å…³ï¼Œä½†æœ€è¿‘Islamç­‰äººåœ¨2020å¹´çš„ç ”ç©¶è¡¨æ˜ï¼Œå¸¸ç”¨çš„å¡«å……æ“ä½œèƒ½å¤Ÿéšå¼åœ°å­¦ä¹ ä½ç½®ä¿¡æ¯ã€‚æœ€è¿‘ï¼ŒåŸºäºTransformerï¼ˆVaswaniç­‰äººäº2017å¹´æå‡ºï¼‰æ„å»ºçš„é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼ˆPLMsï¼‰åœ¨å„ç§è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰ä»»åŠ¡ä¸­å–å¾—äº†é¢†å…ˆçš„æ€§èƒ½ï¼Œæ¯”å¦‚ä¸Šä¸‹æ–‡è¡¨ç¤ºå­¦ä¹ ï¼ˆDevlinç­‰äººåœ¨2019å¹´çš„ç ”ç©¶ï¼‰ã€æœºå™¨ç¿»è¯‘ï¼ˆVaswaniç­‰äººåœ¨2017å¹´çš„ç ”ç©¶ï¼‰ä»¥åŠè¯­è¨€å»ºæ¨¡ï¼ˆRadfordç­‰äººåœ¨2019å¹´çš„ç ”ç©¶ï¼‰ç­‰ã€‚ä¸åŸºäºRNNå’ŒCNNçš„æ¨¡å‹ä¸åŒï¼Œé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åˆ©ç”¨è‡ªæ³¨æ„åŠ›æœºåˆ¶ä»è¯­ä¹‰ä¸Šæ•æ‰ç»™å®šè¯­æ–™åº“çš„ä¸Šä¸‹æ–‡è¡¨ç¤ºã€‚å› æ­¤ï¼Œç›¸è¾ƒäºRNNï¼Œé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨å¹¶è¡ŒåŒ–æ–¹é¢æœ‰äº†æ˜¾è‘—æå‡ï¼Œå¹¶ä¸”ä¸CNNç›¸æ¯”ï¼Œå…¶åœ¨å¯¹æ›´é•¿çš„è¯å†…å…³ç³»è¿›è¡Œå»ºæ¨¡çš„èƒ½åŠ›ä¸Šä¹Ÿæœ‰æ‰€æé«˜ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“å‰é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„è‡ªæ³¨æ„åŠ›æ¶æ„å·²è¢«è¯æ˜æ˜¯ä¸ä½ç½®æ— å…³çš„ï¼ˆYunç­‰äººï¼Œ2020å¹´ï¼‰ã€‚åŸºäºè¿™ä¸€è§‚ç‚¹ï¼Œäººä»¬æå‡ºäº†å„ç§æ–¹æ³•æ¥å°†ä½ç½®ä¿¡æ¯ç¼–ç åˆ°å­¦ä¹ è¿‡ç¨‹ä¸­ã€‚ä¸€æ–¹é¢ï¼Œé€šè¿‡é¢„å®šä¹‰å‡½æ•°ç”Ÿæˆçš„ç»å¯¹ä½ç½®ç¼–ç ï¼ˆVaswaniç­‰äººï¼Œ2017å¹´ï¼‰è¢«æ·»åŠ åˆ°ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸­ï¼ŒåŒæ—¶è¿˜æœ‰å¯è®­ç»ƒçš„ç»å¯¹ä½ç½®ç¼–ç ï¼ˆGehringç­‰äººï¼Œ2017å¹´ï¼›Devlinç­‰äººï¼Œ2019å¹´ï¼›Lanç­‰äººï¼Œ2020å¹´ï¼›Clarkç­‰äººï¼Œ2020å¹´ï¼›Radfordç­‰äººï¼Œ2019å¹´ï¼›Radfordå’ŒNarasimhanï¼Œ2018å¹´ï¼‰ã€‚å¦ä¸€æ–¹é¢ï¼Œå…ˆå‰çš„ç ”ç©¶å·¥ä½œï¼ˆParikhç­‰äººï¼Œ2016å¹´ï¼›Shawç­‰äººï¼Œ2018å¹´ï¼›Huangç­‰äººï¼Œ2018å¹´ï¼›Daiç­‰äººï¼Œ2019å¹´ï¼›Yangç­‰äººï¼Œ2019å¹´ï¼›Raffelç­‰äººï¼Œ2020å¹´ï¼›Keç­‰äººï¼Œ2020å¹´ï¼›Heç­‰äººï¼Œ2020å¹´ï¼›Huangç­‰äººï¼Œ2020å¹´ï¼‰åˆ™ä¸“æ³¨äºç›¸å¯¹ä½ç½®ç¼–ç ï¼Œè¿™ç§ç¼–ç é€šå¸¸ä¼šå°†ç›¸å¯¹ä½ç½®ä¿¡æ¯ç¼–ç åˆ°æ³¨æ„åŠ›æœºåˆ¶ä¸­ã€‚é™¤äº†è¿™äº›æ–¹æ³•ä¹‹å¤–ï¼ŒLiuç­‰äººï¼ˆ2020å¹´ï¼‰çš„ä½œè€…ä»ç¥ç»å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆNeural ODEï¼ŒChenç­‰äººï¼Œ2018aï¼‰çš„è§’åº¦æå‡ºå¯¹ä½ç½®ç¼–ç çš„ä¾èµ–å…³ç³»è¿›è¡Œå»ºæ¨¡ï¼Œè€ŒWangç­‰äººï¼ˆ2020å¹´ï¼‰çš„ä½œè€…åˆ™æå‡ºåœ¨å¤ç©ºé—´ä¸­å¯¹ä½ç½®ä¿¡æ¯è¿›è¡Œå»ºæ¨¡ã€‚å°½ç®¡è¿™äº›æ–¹æ³•éƒ½æœ‰ä¸€å®šçš„æ•ˆæœï¼Œä½†å®ƒä»¬é€šå¸¸æ˜¯å°†ä½ç½®ä¿¡æ¯æ·»åŠ åˆ°ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸­ï¼Œå› æ­¤å¹¶ä¸é€‚ç”¨äºçº¿æ€§è‡ªæ³¨æ„åŠ›æ¶æ„ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ–°é¢–çš„æ–¹æ³•ï¼Œå³æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ï¼Œä»¥ä¾¿åœ¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å­¦ä¹ è¿‡ç¨‹ä¸­åˆ©ç”¨ä½ç½®ä¿¡æ¯ã€‚å…·ä½“è€Œè¨€ï¼ŒRoPEä½¿ç”¨æ—‹è½¬çŸ©é˜µå¯¹ç»å¯¹ä½ç½®è¿›è¡Œç¼–ç ï¼ŒåŒæ—¶åœ¨è‡ªæ³¨æ„åŠ›å…¬å¼ä¸­çº³å…¥äº†æ˜ç¡®çš„ç›¸å¯¹ä½ç½®ä¾èµ–å…³ç³»ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰€æå‡ºçš„RoPEé€šè¿‡ä¸€äº›æœ‰ä»·å€¼çš„ç‰¹æ€§ä¼˜äºç°æœ‰æ–¹æ³•ï¼Œè¿™äº›ç‰¹æ€§åŒ…æ‹¬åºåˆ—é•¿åº¦çš„çµæ´»æ€§ã€éšç€ç›¸å¯¹è·ç¦»å¢åŠ è€Œè¡°å‡çš„è¯é—´ä¾èµ–å…³ç³»ï¼Œä»¥åŠä¸ºçº¿æ€§è‡ªæ³¨æ„åŠ›é…å¤‡ç›¸å¯¹ä½ç½®ç¼–ç çš„èƒ½åŠ›ã€‚åœ¨å„ç§é•¿æ–‡æœ¬åˆ†ç±»åŸºå‡†æ•°æ®é›†ä¸Šçš„å®éªŒç»“æœè¡¨æ˜ï¼Œé‡‡ç”¨æ—‹è½¬ä½ç½®åµŒå…¥çš„å¢å¼ºå‹Transformerï¼Œå³RoFormerï¼Œä¸åŸºçº¿æ–¹æ³•ç›¸æ¯”èƒ½å¤Ÿå–å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œä»è€Œè¯æ˜äº†æ‰€æå‡ºçš„RoPEçš„æœ‰æ•ˆæ€§ã€‚</p>
<p>ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬çš„è´¡çŒ®æœ‰ä»¥ä¸‹ä¸‰ä¸ªæ–¹é¢:</p>
<ol>
<li>
<p>æˆ‘ä»¬ç ”ç©¶äº†ç°æœ‰çš„ç›¸å¯¹ä½ç½®ç¼–ç æ–¹æ³•ï¼Œå‘ç°å®ƒä»¬å¤§å¤šæ˜¯åŸºäºå°†ä½ç½®ç¼–ç æ·»åŠ åˆ°ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸­å¹¶è¿›è¡Œåˆ†è§£çš„æ€è·¯æ„å»ºçš„ã€‚æˆ‘ä»¬å¼•å…¥äº†ä¸€ç§æ–°é¢–çš„æ–¹æ³•ï¼Œå³æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ï¼Œä»¥ä¾¿å°†ä½ç½®ä¿¡æ¯åˆ©ç”¨åˆ°é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ï¼ˆPLMsï¼‰çš„å­¦ä¹ è¿‡ç¨‹ä¸­ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡å°†ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸ä¸€ä¸ªå…·æœ‰æ˜ç¡®ç†è®ºè§£é‡Šçš„æ—‹è½¬çŸ©é˜µç›¸ä¹˜æ¥å¯¹ç›¸å¯¹ä½ç½®è¿›è¡Œç¼–ç ã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬ç ”ç©¶äº†æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„ç‰¹æ€§ï¼Œç»“æœè¡¨æ˜å®ƒä¼šéšç€ç›¸å¯¹è·ç¦»çš„å¢åŠ è€Œè¡°å‡ï¼Œè¿™æ­£æ˜¯è‡ªç„¶è¯­è¨€ç¼–ç æ‰€æœŸæœ›çš„ã€‚æˆ‘ä»¬è®¤ä¸ºï¼Œå…ˆå‰åŸºäºç›¸å¯¹ä½ç½®ç¼–ç çš„æ–¹æ³•å¹¶ä¸é€‚ç”¨äºçº¿æ€§è‡ªæ³¨æ„åŠ›æœºåˆ¶ã€‚</p>
</li>
<li>
<p>æˆ‘ä»¬åœ¨å„ç§é•¿æ–‡æœ¬åŸºå‡†æ•°æ®é›†ä¸Šå¯¹æ‰€æå‡ºçš„RoFormerè¿›è¡Œäº†è¯„ä¼°ã€‚æˆ‘ä»¬çš„å®éªŒè¡¨æ˜ï¼Œä¸å…¶ä»–åŒç±»æ¨¡å‹ç›¸æ¯”ï¼Œå®ƒå§‹ç»ˆèƒ½å–å¾—æ›´å¥½çš„æ€§èƒ½ã€‚ä¸€äº›ä½¿ç”¨é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„å®éªŒå†…å®¹å¯åœ¨GitHubä¸Šè·å–ï¼Œç½‘å€ä¸ºï¼šhttps://github.com/ZhuiyiTechnology/roformer ã€‚</p>
</li>
</ol>
<p>æœ¬æ–‡çš„å…¶ä½™éƒ¨åˆ†ç»„ç»‡å¦‚ä¸‹ã€‚æˆ‘ä»¬åœ¨ç¬¬ï¼ˆ2ï¼‰èŠ‚ä¸­å¯¹è‡ªæ³¨æ„åŠ›æ¶æ„ä¸­çš„ä½ç½®ç¼–ç é—®é¢˜è¿›è¡Œäº†æ­£å¼æè¿°ï¼Œå¹¶å›é¡¾äº†å…ˆå‰çš„ç ”ç©¶æˆæœã€‚ç„¶åï¼Œæˆ‘ä»¬åœ¨ç¬¬ï¼ˆ3ï¼‰èŠ‚ä¸­ä»‹ç»æ—‹è½¬ä½ç½®ç¼–ç ï¼ˆRoPEï¼‰å¹¶ç ”ç©¶å…¶ç‰¹æ€§ã€‚æˆ‘ä»¬åœ¨ç¬¬ï¼ˆ4ï¼‰èŠ‚ä¸­æŠ¥å‘Šå®éªŒç»“æœã€‚æœ€åï¼Œæˆ‘ä»¬åœ¨ç¬¬ï¼ˆ5ï¼‰èŠ‚ä¸­å¯¹æœ¬æ–‡è¿›è¡Œæ€»ç»“ã€‚</p>
<h2 id="èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ">èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ</h2>
<h3 id="é¢„å¤‡å·¥ä½œ">é¢„å¤‡å·¥ä½œ</h3>
<p>è®¾ $S_N = \{ w_i \}_{i = 1}^N$ ä¸ºä¸€ä¸ªç”± $N$ ä¸ªè¾“å…¥è¯å…ƒç»„æˆçš„åºåˆ—ï¼Œå…¶ä¸­ $w_{i}$ æ˜¯ç¬¬ $i$ ä¸ªå…ƒç´ ã€‚$S_N$ å¯¹åº”çš„è¯åµŒå…¥è¡¨ç¤ºä¸º $E_N = \{ x_i \}_{i = 1}^N$ ï¼Œå…¶ä¸­ $x_i \in \mathbb{R}^d$ æ˜¯è¯å…ƒ $w_{i}$ çš„ $d$ ç»´è¯åµŒå…¥å‘é‡ï¼Œä¸”ä¸åŒ…å«ä½ç½®ä¿¡æ¯ã€‚è‡ªæ³¨æ„åŠ›æœºåˆ¶é¦–å…ˆå°†ä½ç½®ä¿¡æ¯èå…¥è¯åµŒå…¥ä¸­ï¼Œç„¶åå°†å®ƒä»¬è½¬æ¢ä¸ºæŸ¥è¯¢ã€é”®å’Œå€¼è¡¨ç¤ºã€‚</p>
\[{q_m} = {f_q}\left( {{x_m},m} \right)\]<p>
</p>
\[{k_n} = {f_k}\left( {{x_n},n} \right)\]<p>
</p>
\[{v_n} = {f_v}\left( {{x_n},n} \right)\]<p>å…¶ä¸­ \(q_m\)ã€\(k_n\)å’Œ\(v_n\) åˆ†åˆ«é€šè¿‡ \(f_q\)ã€\(f_k\) å’Œ \(f_v\) èå…¥äº†ç¬¬ \(m\) ä¸ªå’Œç¬¬ \(n\) ä¸ªä½ç½®çš„ä¿¡æ¯ã€‚ç„¶åï¼ŒæŸ¥è¯¢å€¼å’Œé”®å€¼è¢«ç”¨äºè®¡ç®—æ³¨æ„åŠ›æƒé‡ï¼Œè€Œè¾“å‡ºåˆ™è®¡ç®—ä¸ºå€¼è¡¨ç¤ºçš„åŠ æƒå’Œã€‚</p>
\[{a_{m,n}} = \frac{{\exp \left( {\frac{{q_m^T{k_n}}}{{\sqrt d }}} \right)}}{{\sum\nolimits_{j = 1}^N {\exp \left( {\frac{{q_m^T{k_j}}}{{\sqrt d }}} \right)} }}\]\[{o_m} = \sum\limits_{n - 1}^N {{a_{m,n}}{\upsilon _n}} \]<p>ç°æœ‰çš„åŸºäºTransformerçš„ä½ç½®ç¼–ç æ–¹æ³•ä¸»è¦ä¾§é‡äºé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„å‡½æ•°æ¥æ„æˆå…¬å¼ï¼ˆ1ï¼‰ã€‚</p>
<h3 id="absolute-position-embedding">Absolute position embedding</h3>
<p>å…¬å¼ï¼ˆ1ï¼‰çš„ä¸€ä¸ªå…¸å‹é€‰æ‹©æ˜¯ï¼š</p>
\[{f_{t:t \in \left\{ {q,k,v} \right\}}}\left( {{x_i},i} \right): = {W_{t:t \in \left\{ {q,k,v} \right\}}}\left( {{x_i} + {p_i}} \right)\]<p>ï¼ˆè§£é‡Šï¼šå¯¹äº\(t\in\{q,k,v\}\)ï¼Œ\(f_{t:t \in \{ {q,k,v} \} }(x_i, i)\)å®šä¹‰ä¸ºï¼šå¯¹äº\(t\in\{q,k,v\}\)ï¼Œ\(W_{t:t \in \{ {q,k,v} \} }\)ä½œç”¨äº\((x_i + p_i)\)  ï¼Œå…¶ä¸­\(x_i\)å’Œ\(p_i\)ä¸ºç›¸å…³å‘é‡ï¼Œ\(W_{t:t \in \{ {q,k,v} \} }\)ä¸ºç›¸åº”çš„çŸ©é˜µå˜æ¢ã€‚ï¼‰</p>
<p>å…¶ä¸­ \(p_i\in\mathbb{R}^d\)æ˜¯ä¸€ä¸ª \(d\) ç»´å‘é‡ï¼Œå®ƒå–å†³äºè¯å…ƒ \(x_i\) çš„ä½ç½®ã€‚å…ˆå‰çš„ç ”ç©¶å¼•å…¥äº†ä½¿ç”¨ä¸€ç»„å¯è®­ç»ƒå‘é‡ \(p_i\in\{p_t\}_{t = 1}^L\) çš„æ–¹æ³•ï¼Œå…¶ä¸­ \(L\) æ˜¯æœ€å¤§åºåˆ—é•¿åº¦ã€‚ç“¦æ–¯ç“¦å°¼ç­‰äººï¼ˆ2017å¹´ï¼‰çš„ä½œè€…æå‡ºä½¿ç”¨æ­£å¼¦å‡½æ•°æ¥ç”Ÿæˆ \(p_i\)ã€‚</p>
\[\left\{ {\begin{array}{*{20}{c}}
{{p_{i,2t}} = \sin \left( {k/{{10000}^{2t/d}}} \right)}\\
{{p_{i,2t + 1}} = \cos \left( {k/{{10000}^{2t/d}}} \right)}
\end{array}} \right.\]<p>å…¶ä¸­ \(p_{i,2t}\) æ˜¯ \(d\) ç»´å‘é‡ \(p_i\) çš„ç¬¬ \(2t\) ä¸ªå…ƒç´ ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è¡¨æ˜ï¼Œä»æ­£å¼¦å‡½æ•°çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬æå‡ºçš„æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ä¸è¿™ç§ç›´è§‰ç›¸å…³ã€‚ç„¶è€Œï¼ŒRoPEä¸æ˜¯ç›´æ¥å°†ä½ç½®ä¿¡æ¯æ·»åŠ åˆ°ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸­ï¼Œè€Œæ˜¯æè®®é€šè¿‡ä¸æ­£å¼¦å‡½æ•°ç›¸ä¹˜æ¥èå…¥ç›¸å¯¹ä½ç½®ä¿¡æ¯ã€‚</p>
<h3 id="relative-position-embedding">Relative position embedding</h3>
<p>è‚–ï¼ˆShawï¼‰ç­‰äººï¼ˆ2018å¹´ï¼‰çš„ä½œè€…é‡‡ç”¨äº†å¦‚ä¸‹å¯¹å…¬å¼ï¼ˆ1ï¼‰çš„ä¸åŒè®¾ç½®ï¼š</p>
\[{f_q}\left( {{x_m}} \right): = {W_q}{x_m}\]\[{f_k}\left( {{x_n},n} \right): = {W_k}\left( {{x_n} + \tilde p_r^k} \right)\]\[{f_v}\left( {{x_n},n} \right): = {W_v}\left( {{x_n} + \tilde p_r^v} \right)\]<p>å…¶ä¸­ \(\tilde p_r^k\)ï¼Œ\(\tilde p_r^v \in \mathbb{R}^d\) æ˜¯å¯è®­ç»ƒçš„ç›¸å¯¹ä½ç½®åµŒå…¥ã€‚è¯·æ³¨æ„ï¼Œ\(r = clip(m - n, r_{min}, r_{max})\) è¡¨ç¤ºä½ç½® \(m\) å’Œ \(n\) ä¹‹é—´çš„ç›¸å¯¹è·ç¦»ã€‚ä»–ä»¬å¯¹ç›¸å¯¹è·ç¦»è¿›è¡Œäº†æˆªæ–­å¤„ç†ï¼Œå…¶å‡è®¾æ˜¯è¶…è¿‡ä¸€å®šè·ç¦»åï¼Œç²¾ç¡®çš„ç›¸å¯¹ä½ç½®ä¿¡æ¯å°±æ²¡æœ‰ç”¨å¤„äº†ã€‚æˆ´ï¼ˆDaiï¼‰ç­‰äººï¼ˆ2019å¹´ï¼‰åœ¨ä¿æŒå…¬å¼ï¼ˆ3ï¼‰å½¢å¼çš„æƒ…å†µä¸‹ï¼Œæè®®å°†å…¬å¼ï¼ˆ2ï¼‰ä¸­çš„ \(q_m^T{k_n}\) åˆ†è§£ä¸º:
</p>
\[q_m^T{k_n} = x_m^TW_q^T{W_k}{x_n} + x_m^TW_q^T{W_k}{p_n} + p_m^TW_q^T{W_k}{x_n} + p_m^TW_q^T{W_k}{p_n}\]<p>å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨ç»è¿‡æ­£å¼¦ç¼–ç çš„ç›¸å¯¹ä½ç½®åµŒå…¥\(\tilde{p}_{m - n}\)æ¥æ›¿ä»£ç»å¯¹ä½ç½®åµŒå…¥\(p_n\)ï¼Œè€Œç¬¬ä¸‰é¡¹å’Œç¬¬å››é¡¹ä¸­çš„ç»å¯¹ä½ç½®\(p_m\)åˆ™ç”¨ä¸¤ä¸ªä¸æŸ¥è¯¢ä½ç½®æ— å…³çš„å¯è®­ç»ƒå‘é‡\(u\)å’Œ\(v\)æ¥ä»£æ›¿ã€‚æ­¤å¤–ï¼Œå¯¹äºåŸºäºå†…å®¹çš„é”®å‘é‡\(x_n\)å’ŒåŸºäºä½ç½®çš„é”®å‘é‡\(p_n\)ï¼Œ\(W_k\)æ˜¯æœ‰åŒºåˆ«çš„ï¼Œåˆ†åˆ«è®°ä¸º\(W_k\)å’Œ ${\tilde W}_k$ï¼Œä»è€Œå¾—åˆ°ï¼š</p>
\[q_m^T{k_n} = x_m^TW_q^T{W_k}{x_n} + x_m^TW_q^T{{\tilde W}_k}{{\tilde p}_{m - n}} + {u^T}W_q^T{W_k}{x_n} + {v^T}W_q^T{{\tilde W}_k}{{\tilde p}_{m - n}}\]<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡è®¾ç½®\(f_v(x_j): = W_vx_j\)ï¼Œå€¼é¡¹ä¸­çš„ä½ç½®ä¿¡æ¯è¢«å»é™¤äº†ã€‚åæ¥çš„ç ”ç©¶ä¸­æ²¿ç”¨äº†è¿™äº›è®¾ç½®ï¼Œä»…å°†ç›¸å¯¹ä½ç½®ä¿¡æ¯ç¼–ç åˆ°æ³¨æ„åŠ›æƒé‡ä¸­ã€‚ç„¶è€Œï¼Œæ‹‰è²å°”ï¼ˆRaffelï¼‰ç­‰äººï¼ˆ2020å¹´ï¼‰çš„ä½œè€…å°†å…¬å¼ï¼ˆ6ï¼‰ä¿®æ”¹ä¸ºï¼š</p>
\[q_m^T{k_n} = x_m^TW_q^T{W_k}{x_n} + {b_{i,j}}\]<p>å…¶ä¸­\(b_{i,j}\)æ˜¯ä¸€ä¸ªå¯è®­ç»ƒçš„åå·®é¡¹ã€‚æŸ¯ï¼ˆKeï¼‰ç­‰äººï¼ˆ2020å¹´ï¼‰çš„ä½œè€…ç ”ç©¶äº†å…¬å¼ï¼ˆ6ï¼‰ä¸­é—´çš„ä¸¤é¡¹ï¼Œå‘ç°ç»å¯¹ä½ç½®å’Œå•è¯ä¹‹é—´å‡ ä¹æ²¡æœ‰ç›¸å…³æ€§ã€‚æ‹‰è²å°”ï¼ˆRaffelï¼‰ç­‰äººï¼ˆ2020å¹´ï¼‰çš„ä½œè€…æè®®ä½¿ç”¨ä¸åŒçš„æŠ•å½±çŸ©é˜µå¯¹ä¸€å¯¹å•è¯æˆ–ä½ç½®è¿›è¡Œå»ºæ¨¡ã€‚
</p>
\[q_m^T{k_n} = x_m^TW_q^T{W_k}{x_n} + p_m^TU_q^T{U_k}{p_n} + {b_{i,j}}\]<p>ä½•ç­‰äººï¼ˆ2020å¹´ï¼‰çš„ä½œè€…è®¤ä¸ºï¼Œåªæœ‰ä½¿ç”¨å…¬å¼ï¼ˆ6ï¼‰ä¸­é—´çš„ä¸¤é¡¹æ‰èƒ½å¯¹ä¸¤ä¸ªè¯å…ƒçš„ç›¸å¯¹ä½ç½®è¿›è¡Œå®Œæ•´å»ºæ¨¡ã€‚å› æ­¤ï¼Œç»å¯¹ä½ç½®åµŒå…¥\(p_m\)å’Œ\(p_n\)è¢«ç®€å•åœ°æ›¿æ¢ä¸ºç›¸å¯¹ä½ç½®åµŒå…¥\(\tilde{p}_{m - n}\)ï¼š</p>
\[q_m^T{k_n} = x_m^TW_q^T{W_k}{x_n} + x_m^TW_q^T{W_k}{{\tilde p}_{m - n}} + \tilde p_{m - n}^TW_q^T{W_k}{x_n}\]<p>æ‹‰å¾·ç¦å¾·ï¼ˆRadfordï¼‰å’Œçº³æ‹‰è¥¿å§†æ±‰ï¼ˆNarasimhanï¼‰ï¼ˆ2018å¹´ï¼‰å¯¹ç›¸å¯¹ä½ç½®åµŒå…¥çš„å››ç§å˜ä½“è¿›è¡Œäº†æ¯”è¾ƒï¼Œç»“æœè¡¨æ˜ï¼Œä¸å…¬å¼ï¼ˆ10ï¼‰ç±»ä¼¼çš„å˜ä½“åœ¨å…¶ä»–ä¸‰ç§å˜ä½“ä¸­æ•ˆç‡æœ€é«˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½è¯•å›¾åœ¨å…¬å¼ï¼ˆ2ï¼‰çš„è‡ªæ³¨æ„åŠ›è®¾ç½®ä¸‹ï¼ŒåŸºäºå…¬å¼ï¼ˆ3ï¼‰çš„åˆ†è§£æ¥ä¿®æ”¹å…¬å¼ï¼ˆ6ï¼‰ï¼Œè€Œå…¬å¼ï¼ˆ2ï¼‰æœ€åˆæ˜¯ç”±ç“¦æ–¯ç“¦å°¼ï¼ˆVaswaniï¼‰ç­‰äººï¼ˆ2017å¹´ï¼‰æå‡ºçš„ã€‚å®ƒä»¬é€šå¸¸é‡‡ç”¨ç›´æ¥å°†ä½ç½®ä¿¡æ¯æ·»åŠ åˆ°ä¸Šä¸‹æ–‡è¡¨ç¤ºä¸­çš„æ–¹å¼ã€‚ä¸åŒçš„æ˜¯ï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ—¨åœ¨åœ¨ä¸€äº›çº¦æŸæ¡ä»¶ä¸‹ä»å…¬å¼ï¼ˆ1ï¼‰æ¨å¯¼å‡ºç›¸å¯¹ä½ç½®ç¼–ç ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†è¡¨æ˜ï¼Œé€šè¿‡å°†ç›¸å¯¹ä½ç½®ä¿¡æ¯ä¸ä¸Šä¸‹æ–‡è¡¨ç¤ºçš„æ—‹è½¬ç›¸ç»“åˆï¼Œæ‰€æ¨å¯¼å‡ºçš„æ–¹æ³•æ›´å…·å¯è§£é‡Šæ€§ã€‚</p>
<h2 id="proposed-approach">Proposed approach</h2>
<p>åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæ‰€æå‡ºçš„æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ã€‚æˆ‘ä»¬é¦–å…ˆåœ¨ç¬¬ï¼ˆ3.1ï¼‰èŠ‚ä¸­é˜è¿°ç›¸å¯¹ä½ç½®ç¼–ç é—®é¢˜ï¼Œç„¶ååœ¨ç¬¬ï¼ˆ3.2ï¼‰èŠ‚ä¸­æ¨å¯¼å‡ºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ï¼Œå¹¶åœ¨ç¬¬ï¼ˆ3.3ï¼‰èŠ‚ä¸­ç ”ç©¶å…¶ç‰¹æ€§ã€‚</p>
<h3 id="formulation">Formulation</h3>
<p>åŸºäºTransformerçš„è¯­è¨€å»ºæ¨¡é€šå¸¸é€šè¿‡è‡ªæ³¨æ„åŠ›æœºåˆ¶æ¥åˆ©ç”¨å•ä¸ªè¯å…ƒçš„ä½ç½®ä¿¡æ¯ã€‚æ­£å¦‚åœ¨å…¬å¼ï¼ˆ2ï¼‰ä¸­å¯ä»¥çœ‹åˆ°çš„é‚£æ ·ï¼Œ\(q_m^T{k_n}\) é€šå¸¸èƒ½å¤Ÿåœ¨ä¸åŒä½ç½®çš„è¯å…ƒä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚ä¸ºäº†èå…¥ç›¸å¯¹ä½ç½®ä¿¡æ¯ï¼Œæˆ‘ä»¬è¦æ±‚æŸ¥è¯¢å‘é‡ \(q_m\) å’Œé”®å‘é‡ \(k_n\) çš„å†…ç§¯ç”±ä¸€ä¸ªå‡½æ•° \(g\) æ¥è¡¨ç¤ºï¼Œè¯¥å‡½æ•°ä»…å°†è¯åµŒå…¥å‘é‡ \(x_m\)ã€\(x_n\) ä»¥åŠå®ƒä»¬çš„ç›¸å¯¹ä½ç½® \(m - n\) ä½œä¸ºè¾“å…¥å˜é‡ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¸Œæœ›è¿™ä¸ªå†…ç§¯ä»…ä»¥ç›¸å¯¹å½¢å¼å¯¹ä½ç½®ä¿¡æ¯è¿›è¡Œç¼–ç ï¼š</p>
\[\left\langle {{f_q}\left( {{x_m},m} \right),{f_k}\left( {{x_n},n} \right)} \right\rangle  = g\left( {{x_m},{x_n},m - n} \right)\]<p>æœ€ç»ˆç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ç§ç­‰æ•ˆçš„ç¼–ç æœºåˆ¶æ¥æ±‚è§£å‡½æ•° \(f_q(x_m, m)\)å’Œ\(f_k(x_n, n)\)ï¼Œä½¿å…¶ç¬¦åˆä¸Šè¿°å…³ç³»ã€‚</p>
<h2 id="rotary-position-embedding">Rotary position embedding</h2>
<h3 id="a-2d-case">A 2D case</h3>
<p>æˆ‘ä»¬ä»ç»´åº¦ \(d = 2\) çš„ç®€å•æƒ…å†µå…¥æ‰‹ã€‚åœ¨è¿™äº›è®¾å®šä¸‹ï¼Œæˆ‘ä»¬åˆ©ç”¨äºŒç»´å¹³é¢ä¸Šå‘é‡çš„å‡ ä½•æ€§è´¨åŠå…¶å¤æ•°å½¢å¼æ¥è¯æ˜ï¼ˆæ›´å¤šç»†èŠ‚è¯·å‚è€ƒç¬¬ï¼ˆ3.4.1ï¼‰èŠ‚ï¼‰ï¼Œæˆ‘ä»¬çš„å…¬å¼ï¼ˆ11ï¼‰çš„ä¸€ä¸ªè§£ä¸ºï¼š</p>
\[g\left( {{x_m},{x_n},m - n} \right) = {\mathop{\rm Re}\nolimits} \left[ {\left( {{W_q}{x_m}} \right){{\left( {{W_k}{x_n}} \right)}^*}{e^{i\left( {m - n} \right)\theta }}} \right]\]<p>å…¶ä¸­ \(Re[\cdot]\) è¡¨ç¤ºå¤æ•°çš„å®éƒ¨ï¼Œ\((W_k x_n)^*\) è¡¨ç¤º \((W_k x_n)\) çš„å…±è½­å¤æ•°ã€‚
\(\theta\in\mathbb{R}\) æ˜¯ä¸€ä¸ªé¢„å…ˆè®¾å®šçš„éé›¶å¸¸æ•°ã€‚æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥å°† \(f_{\{q,k\}}\) å†™æˆä¸€ä¸ªä¹˜æ³•çŸ©é˜µçš„å½¢å¼ï¼š</p>
\[{f_{\left\{ {q,k} \right\}}}\left( {{x_m},m} \right) = \left( {\begin{array}{*{20}{c}}
{\cos m\theta }&{ - \sin m\theta }\\
{\sin m\theta }&{\cos m\theta }
\end{array}} \right)\left( {\begin{array}{*{20}{c}}
{W_{\left\{ {q,k} \right\}}^{\left( {11} \right)}}&{W_{\left\{ {q,k} \right\}}^{\left( {12} \right)}}\\
{W_{\left\{ {q,k} \right\}}^{\left( {21} \right)}}&{W_{\left\{ {q,k} \right\}}^{\left( {22} \right)}}
\end{array}} \right)\left( {\begin{array}{*{20}{c}}
{x_m^{\left( 1 \right)}}\\
{x_m^{\left( 2 \right)}}
\end{array}} \right)\]<p>å…¶ä¸­ \((x_m^{(1)}, x_m^{(2)})\) æ˜¯ \(x_m\) åœ¨äºŒç»´åæ ‡ä¸­çš„è¡¨ç¤ºå½¢å¼ã€‚ç±»ä¼¼åœ°ï¼Œ\(g\) å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå› æ­¤åœ¨äºŒç»´æƒ…å†µä¸‹èƒ½å¤Ÿæ±‚è§£ç¬¬ï¼ˆ3.1ï¼‰èŠ‚ä¸­çš„å…¬å¼ã€‚å…·ä½“æ¥è¯´ï¼Œèå…¥ç›¸å¯¹ä½ç½®åµŒå…¥å¾ˆç›´æ¥ï¼šåªéœ€å°†ç»è¿‡ä»¿å°„å˜æ¢çš„è¯åµŒå…¥å‘é‡æŒ‰å…¶ä½ç½®ç´¢å¼•çš„è§’åº¦å€æ•°è¿›è¡Œæ—‹è½¬ï¼Œä»è€Œè§£é‡Šæ—‹è½¬ä½ç½®åµŒå…¥èƒŒåçš„åŸç†ã€‚</p>
<h3 id="general-form">General form</h3>
<p>ä¸ºäº†å°†æˆ‘ä»¬åœ¨äºŒç»´ç©ºé—´ä¸­çš„ç»“æœæ¨å¹¿åˆ°ä»»æ„ \(x_i \in \mathbb{R}^d\)ï¼ˆå…¶ä¸­ \(d\) ä¸ºå¶æ•°ï¼‰çš„æƒ…å†µï¼Œæˆ‘ä»¬å°† \(d\) ç»´ç©ºé—´åˆ’åˆ†ä¸º \(d/2\) ä¸ªå­ç©ºé—´ï¼Œå¹¶åˆ©ç”¨å†…ç§¯çš„çº¿æ€§æ€§è´¨å°†å®ƒä»¬ç»„åˆèµ·æ¥ï¼Œä»è€Œå°† \(f_{\{q,k\}}\) è½¬åŒ–ä¸ºï¼š
</p>
\[{f_{\left\{ {q,k} \right\}}}\left( {{x_m},m} \right) = R_{\Theta ,m}^d{W_{\left\{ {q,k} \right\}}}{x_m}\]<p>
å…¶ä¸­ï¼š
</p>
\[R_{\Theta ,m}^d = \left( {\begin{array}{*{20}{c}}
{\cos m{\theta _1}}&{ - \sin m{\theta _1}}&0&0& \cdots &0&0\\
{\sin m{\theta _1}}&{\cos m{\theta _1}}&0&0& \cdots &0&0\\
0&0&{\cos m{\theta _2}}&{ - \sin m{\theta _2}}& \cdots &0&0\\
0&0&{\sin m{\theta _2}}&{\cos m{\theta _2}}& \cdots &0&0\\
 \vdots & \vdots & \vdots & \vdots & \ddots & \vdots & \vdots \\
0&0&0&0& \cdots &{\cos m{\theta _{d/2}}}&{ - \sin m{\theta _{d/2}}}\\
0&0&0&0& \cdots &{\sin m{\theta _{d/2}}}&{\cos m{\theta _{d/2}}}
\end{array}} \right)\]<p>
æ˜¯å…·æœ‰é¢„å®šä¹‰å‚æ•° \(\Theta = \{ \theta_i = 10000^{-2(i - 1)/d}, i \in [1, 2, \ldots, d/2] \}\) çš„æ—‹è½¬çŸ©é˜µã€‚æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰çš„å›¾ç¤ºå¦‚å›¾ï¼ˆ1ï¼‰æ‰€ç¤ºã€‚å°†æˆ‘ä»¬çš„æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰åº”ç”¨äºå…¬å¼ï¼ˆ2ï¼‰ä¸­çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
\[q_m^T{k_n} = {\left( {R_{\Theta ,m}^d{W_q}{x_m}} \right)^T}\left( {R_{\Theta ,n}^d{W_k}{x_n}} \right) = {x^T}{W_q}R_{\Theta ,n - m}^d{W_k}{x_n}\]<p>å…¶ä¸­ \(R_{\Theta, n - m}^d = (R_{\Theta, m}^d)^T R_{\Theta, n}^d\)ã€‚è¯·æ³¨æ„ï¼Œ\(R_{\Theta, m}^d\) æ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µï¼Œè¿™ç¡®ä¿äº†åœ¨ç¼–ç ä½ç½®ä¿¡æ¯çš„è¿‡ç¨‹ä¸­å…·æœ‰ç¨³å®šæ€§ã€‚æ­¤å¤–ï¼Œç”±äº \(R_{\Theta, m}^d\) å…·æœ‰ç¨€ç–æ€§ï¼Œç›´æ¥åƒå…¬å¼ï¼ˆ16ï¼‰é‚£æ ·è¿›è¡ŒçŸ©é˜µä¹˜æ³•åœ¨è®¡ç®—ä¸Šå¹¶ä¸é«˜æ•ˆï¼›æˆ‘ä»¬å°†åœ¨ç†è®ºè§£é‡Šéƒ¨åˆ†ç»™å‡ºå¦ä¸€ç§å®ç°æ–¹å¼ã€‚</p>
<p>ä¸å…ˆå‰ç ”ç©¶ä¸­æ‰€é‡‡ç”¨çš„ä½ç½®åµŒå…¥æ–¹æ³•ï¼ˆå³å…¬å¼ï¼ˆ3ï¼‰è‡³ï¼ˆ10ï¼‰ï¼‰çš„åŠ æ³•æ€§è´¨ä¸åŒï¼Œæˆ‘ä»¬çš„æ–¹æ³•æ˜¯ä¹˜æ³•æ€§è´¨çš„ã€‚æ­¤å¤–ï¼Œå½“åº”ç”¨äºè‡ªæ³¨æ„åŠ›æœºåˆ¶æ—¶ï¼Œæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰é€šè¿‡æ—‹è½¬çŸ©é˜µä¹˜ç§¯è‡ªç„¶åœ°èå…¥äº†ç›¸å¯¹ä½ç½®ä¿¡æ¯ï¼Œè€Œä¸æ˜¯å»æ”¹å˜åŠ æ³•ä½ç½®ç¼–ç å±•å¼€å¼ä¸­çš„å„é¡¹ã€‚
<script type="text/javascript" src= '/js/pdf-js/build/pdf.js'></script>

<style>
  .pdf-paginator {
    text-align:center;}

  #embed-pdf-container {
    position: relative;
    width: 100%;
    height: auto;
    min-height: 20vh;
     
  }
  
  .pdf-canvas {
    border: 1px solid black;
    direction: ltr;
    width: 100%;
    height: auto;
    display: none;
  }
  
  #the-canvas {
    border: 1px solid black;
    direction: ltr;
    width: 100%;
    height: auto;
    display: none;
  }
  
  
  .pdf-loadingWrapper {
    display: none;
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 350px;
  }
  
  .pdf-loading {
    display: inline-block;
    width: 50px;
    height: 50px;
    border: 3px solid #d2d0d0;;
    border-radius: 50%;
    border-top-color: #383838;
    animation: spin 1s ease-in-out infinite;
    -webkit-animation: spin 1s ease-in-out infinite;
  }
  
  
  
  
  
  #overlayText {
    word-wrap: break-word;
    display: grid;
    justify-content: end;
  }
  
  #overlayText a {
    position: relative;
    top: 10px;
    right: 4px;
    color: #000;
    margin: auto;
    background-color: #eeeeee;
    padding: 0.3em 1em;
    border: solid 2px;
    border-radius: 12px;
    border-color: #00000030;
    text-decoration: none;
  }
  
  #overlayText svg {
    height: clamp(1em, 2vw, 1.4em);
    width:  clamp(1em, 2vw, 1.4em);
  }
  
  
  
  @keyframes spin {
    to { -webkit-transform: rotate(360deg); }
  }
  @-webkit-keyframes spin {
    to { -webkit-transform: rotate(360deg); }
  }

  #overlayText {
        display: none;
  }







  </style><div class="embed-pdf-container" id="embed-pdf-container-013b2179">
    <div class="pdf-loadingWrapper" id="pdf-loadingWrapper-013b2179">
        <div class="pdf-loading" id="pdf-loading-013b2179"></div>
    </div>
    <div id="overlayText">
      <a href="./pic/1.pdf" aria-label="Download" download>
        <svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 18">
            <path d="M9 13c.3 0 .5-.1.7-.3L15.4 7 14 5.6l-4 4V1H8v8.6l-4-4L2.6 7l5.7 5.7c.2.2.4.3.7.3zm-7 2h14v2H2z" />
        </svg>
      </a>
    </div>
    <canvas class="pdf-canvas" id="pdf-canvas-013b2179"></canvas>
</div>

<div class="pdf-paginator" id="pdf-paginator-013b2179">
    <button id="pdf-prev-013b2179">Previous</button>
    <button id="pdf-next-013b2179">Next</button> &nbsp; &nbsp;
    <span>
      <span class="pdf-pagenum" id="pdf-pagenum-013b2179"></span> / <span class="pdf-pagecount" id="pdf-pagecount-013b2179"></span>
    </span>
    <a class="pdf-source" id="pdf-source-013b2179" href="./pic/1.pdf">[pdf]</a>
</div>

<noscript>
View the PDF file <a class="pdf-source" id="pdf-source-noscript-013b2179" href="./pic/1.pdf">here</a>.
</noscript>

<script type="text/javascript">
    (function(){
    var url = '.\/pic\/1.pdf';

    var hidePaginator = "" === "true";
    var hideLoader = "" === "true";
    var selectedPageNum = parseInt("") || 1;


    var showSource = "" === "true";
    var pageSource = document.getElementById("pdf-source-013b2179");

    
    function showSourcef() {
        if(showSource) {
            pageSource.style.display = 'inline';
        } else {
            pageSource.style.display = 'none';
        }
    }

    
    showSourcef();


    
    var pdfjsLib = window['pdfjs-dist/build/pdf'];

    
    if (pdfjsLib.GlobalWorkerOptions.workerSrc == '')
      pdfjsLib.GlobalWorkerOptions.workerSrc = "http:\/\/localhost:1313\/" + 'js/pdf-js/build/pdf.worker.js';

    
    var pdfDoc = null,
        pageNum = selectedPageNum,
        pageRendering = false,
        pageNumPending = null,
        scale = 3,
        canvas = document.getElementById('pdf-canvas-013b2179'),
        ctx = canvas.getContext('2d'),
        paginator = document.getElementById("pdf-paginator-013b2179"),
        loadingWrapper = document.getElementById('pdf-loadingWrapper-013b2179');


    
    showPaginator();
    showLoader();

    

    function renderPage(num) {
      pageRendering = true;
      
      pdfDoc.getPage(num).then(function(page) {
        var viewport = page.getViewport({scale: scale});
        canvas.height = viewport.height;
        canvas.width = viewport.width;

        
        var renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        var renderTask = page.render(renderContext);

        
        renderTask.promise.then(function() {
          pageRendering = false;
          showContent();

          if (pageNumPending !== null) {
            
            renderPage(pageNumPending);
            pageNumPending = null;
          }
        });
      });

      
      document.getElementById('pdf-pagenum-013b2179').textContent = num;
    }

    

    function showContent() {
      loadingWrapper.style.display = 'none';
      canvas.style.display = 'block';
    }

    

    function showLoader() {
      if(hideLoader) return
      loadingWrapper.style.display = 'flex';
      canvas.style.display = 'none';
    }

    

    function showPaginator() {
      if(hidePaginator) return
      paginator.style.display = 'block';
    }

    

    function queueRenderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
      } else {
        renderPage(num);
      }
    }

    

    function onPrevPage() {
      if (pageNum <= 1) {
        return;
      }
      pageNum--;
      queueRenderPage(pageNum);
    }
    document.getElementById('pdf-prev-013b2179').addEventListener('click', onPrevPage);

    

    function onNextPage() {
      if (pageNum >= pdfDoc.numPages) {
        return;
      }
      pageNum++;
      queueRenderPage(pageNum);
    }
    document.getElementById('pdf-next-013b2179').addEventListener('click', onNextPage);

    

    pdfjsLib.getDocument(url).promise.then(function(pdfDoc_) {
      pdfDoc = pdfDoc_;
      var numPages = pdfDoc.numPages;
      document.getElementById('pdf-pagecount-013b2179').textContent = numPages;

      
      if(pageNum > numPages) {
        pageNum = numPages
      }

      
      renderPage(pageNum);
    });
    })();
</script>
</p>
<h3 id="properties-of-rope">Properties of RoPE</h3>
<p>é•¿æœŸè¡°å‡ï¼š
éµå¾ªç“¦æ–¯ç“¦å°¼ï¼ˆVaswaniï¼‰ç­‰äººåœ¨2017å¹´çš„ç ”ç©¶ï¼Œæˆ‘ä»¬è®¾å®š\(\theta_i = 10000^{- \frac{2i}{d}}\)ã€‚å¯ä»¥è¯æ˜ï¼Œè¿™ç§è®¾å®šå…·æœ‰é•¿æœŸè¡°å‡ç‰¹æ€§ï¼ˆæ›´å¤šç»†èŠ‚è¯·å‚è€ƒç¬¬3.4.3èŠ‚ï¼‰ï¼Œè¿™æ„å‘³ç€å½“ç›¸å¯¹ä½ç½®å¢åŠ æ—¶ï¼Œå†…ç§¯å°†ä¼šè¡°å‡ã€‚è¿™ä¸€ç‰¹æ€§ä¸è¿™æ ·çš„ç›´è§‰ç›¸ç¬¦ï¼Œå³ä¸€å¯¹ç›¸å¯¹è·ç¦»è¾ƒè¿œçš„è¯å…ƒä¹‹é—´çš„è”ç³»åº”è¯¥æ›´å°‘ã€‚</p>
<p>å¸¦çº¿æ€§æ³¨æ„åŠ›çš„æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ï¼š
è‡ªæ³¨æ„åŠ›æœºåˆ¶å¯ä»¥è¢«æ”¹å†™ä¸ºä¸€ç§æ›´é€šç”¨çš„å½¢å¼ã€‚</p>
\[Attention{\left( {Q,K,V} \right)_m} = \frac{{\sum\nolimits_{n = 1}^N {sim\left( {{q_m},{k_n}} \right){v_n}} }}{{\sum\nolimits_{n = 1}^N {sim\left( {{q_m},{k_n}} \right)} }}\]<p>åŸå§‹çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶é€‰æ‹©
\( sim\left( {{q_m},{k_n}} \right) = \exp \left( {\frac{{q_m^T{k_n}}}{{\sqrt d }}} \right)\)ã€‚
è¯·æ³¨æ„ï¼ŒåŸå§‹çš„è‡ªæ³¨æ„åŠ›æœºåˆ¶éœ€è¦ä¸ºæ¯ä¸€å¯¹è¯å…ƒè®¡ç®—æŸ¥è¯¢å‘é‡ï¼ˆqueryï¼‰å’Œé”®å‘é‡ï¼ˆkeyï¼‰çš„å†…ç§¯ï¼Œå…¶å…·æœ‰äºŒæ¬¡æ–¹å¤æ‚åº¦\(\mathbb{O}(N^2)\)ã€‚éµå¾ªå¡å¡”ç½—æ³¢æ´›æ–¯ï¼ˆKatharopoulosï¼‰ç­‰äººåœ¨2020å¹´çš„ç ”ç©¶ï¼Œçº¿æ€§æ³¨æ„åŠ›æœºåˆ¶å°†å…¬å¼ï¼ˆ17ï¼‰é‡æ–°è¡¨è¿°ä¸º:
</p>
\[Attention{\left( {Q,K,V} \right)_m} = \frac{{\sum\nolimits_{n = 1}^N {\phi {{\left( {{q_m}} \right)}^T}\varphi \left( {{k_n}} \right){v_n}} }}{{\sum\nolimits_{n = 1}^N {\phi {{\left( {{q_m}} \right)}^T}\varphi \left( {{k_n}} \right)} }}\]<p>å…¶ä¸­\(\phi(\cdot)\)ã€\(\varphi(\cdot)\)é€šå¸¸ä¸ºéè´Ÿå‡½æ•°ã€‚å¡å¡”ç½—æ³¢æ´›æ–¯ï¼ˆKatharopoulosï¼‰ç­‰äººï¼ˆ2020å¹´ï¼‰çš„è®ºæ–‡ä½œè€…æå‡º\(\phi(x)=\varphi(x)=\text{elu}(x) + 1\)ï¼Œå¹¶ä¸”é¦–å…ˆåˆ©ç”¨çŸ©é˜µä¹˜æ³•çš„ç»“åˆå¾‹è®¡ç®—äº†é”®ï¼ˆkeysï¼‰å’Œå€¼ï¼ˆvaluesï¼‰ä¹‹é—´çš„ä¹˜ç§¯ã€‚æ²ˆï¼ˆShenï¼‰ç­‰äººï¼ˆ2021å¹´ï¼‰ä½¿ç”¨äº†ä¸€ä¸ªSoftmaxå‡½æ•°ï¼Œåœ¨å†…ç§¯è¿ç®—ä¹‹å‰åˆ†åˆ«å¯¹æŸ¥è¯¢ï¼ˆqueriesï¼‰å’Œé”®ï¼ˆkeysï¼‰è¿›è¡Œå½’ä¸€åŒ–ï¼Œè¿™ç›¸å½“äº\(\phi(q_i)=\text{softmax}(q_i)\)ä¸”\(\phi(k_j)=\exp(k_j)\)ã€‚å…³äºçº¿æ€§æ³¨æ„åŠ›çš„æ›´å¤šç»†èŠ‚ï¼Œæˆ‘ä»¬å»ºè®®è¯»è€…å‚è€ƒç›¸å…³çš„åŸå§‹è®ºæ–‡ã€‚åœ¨æœ¬èŠ‚ä¸­ï¼Œæˆ‘ä»¬é‡ç‚¹è®¨è®ºå¦‚ä½•å°†æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰ä¸å…¬å¼ï¼ˆ18ï¼‰ç›¸ç»“åˆã€‚ç”±äºæ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰æ˜¯é€šè¿‡æ—‹è½¬æ¥æ³¨å…¥ä½ç½®ä¿¡æ¯çš„ï¼Œè¿™ä½¿å¾—éšè—è¡¨ç¤ºçš„èŒƒæ•°ä¿æŒä¸å˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†æ—‹è½¬çŸ©é˜µä¸éè´Ÿå‡½æ•°çš„è¾“å‡ºç›¸ä¹˜ï¼Œæ¥å°†æ—‹è½¬ä½ç½®åµŒå…¥ï¼ˆRoPEï¼‰å’Œçº¿æ€§æ³¨æ„åŠ›ç»“åˆèµ·æ¥:</p>
\[Attention{\left( {Q,K,V} \right)_m} = \frac{{\sum\nolimits_{n = 1}^N {{{\left( {R_{\Theta ,m}^d\phi \left( {{q_m}} \right)} \right)}^T}\left( {R_{\Theta ,n}^d\varphi \left( {{k_n}} \right)} \right){v_n}} }}{{\sum\nolimits_{n = 1}^N {\phi {{\left( {{q_m}} \right)}^T}\varphi \left( {{k_n}} \right)} }}\]<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¿æŒåˆ†æ¯ä¸å˜ï¼Œä»¥é¿å…å‡ºç°é™¤é›¶çš„é£é™©ï¼Œå¹¶ä¸”åˆ†å­ä¸­çš„æ±‚å’Œå¯èƒ½åŒ…å«è´Ÿé¡¹ã€‚å°½ç®¡å…¬å¼ï¼ˆ19ï¼‰ä¸­æ¯ä¸ªå€¼\(v_i\)çš„æƒé‡å¹¶éä¸¥æ ¼æŒ‰ç…§æ¦‚ç‡è¿›è¡Œå½’ä¸€åŒ–ï¼Œä½†æˆ‘ä»¬è®¤ä¸ºè¿™ç§è®¡ç®—æ–¹å¼ä»ç„¶èƒ½å¤Ÿå¯¹å€¼çš„é‡è¦æ€§è¿›è¡Œå»ºæ¨¡ã€‚</p>
<h3 id="theoretical-explanation">Theoretical Explanation</h3>
<h4 id="derivation-of-rope-under-2d">Derivation of RoPE under 2D</h4>
<p>Under the case of d = 2, we consider two-word embedding vectors xq, xk corresponds to query and key and their
position m and n, respectively. According to eq. (1), their position-encoded counterparts are:
</p>
\[{q_m} = {f_q}\left( {{x_m},m} \right)\]<p>
</p>
\[{k_n} = {f_k}\left( {{x_k},n} \right)\]<p>
where the subscripts of qm and kn indicate the encoded positions information. Assume that there exists a function g
that defines the inner product between vectors produced by f{q,k}:</p>
\[q_m^T{k_n} = \left\langle {{f_q}\left( {{x_m},m} \right),{f_k}\left( {{x_n},n} \right)} \right\rangle  = g\left( {{x_m},{x_n},n - m} \right)\]<p>we further require below initial condition to be satisfied:
</p>
\[q = {f_q}\left( {{x_q},0} \right)\]<p>
</p>
\[k = {f_k}\left( {{x_k},0} \right)\]<p>
which can be read as the vectors with empty position information encoded. Given these settings, we attempt to find a
solution of fq, fk. First, we take advantage of the geometric meaning of vector in 2D and its complex counter part,
decompose functions in Equations (20) and (21) into:</p>
\[{f_q}\left( {{x_q},m} \right) = {R_q}\left( {{x_q},m} \right){e^{i{\Theta _q}\left( {{x_q},m} \right)}}\]<p>
</p>
\[{f_k}\left( {{x_k},n} \right) = {R_k}\left( {{x_k},n} \right){e^{i{\Theta _k}\left( {{x_k},n} \right)}}\]<p>
</p>
\[g\left( {{x_q},{x_k},n - m} \right) = {R_g}\left( {{x_q},{x_k},n - m} \right){e^{i{\Theta _g}\left( {{x_q},{x_k},n - m} \right)}}\]<p>
where Rf, Rg and Î˜f, Î˜g are the radical and angular components for f{q,k} and g, respectively. Plug them into
Equation (21), we get the relation:</p>

        
      </section>

      

      
    </article>
  </div>

  <div
    x-data="tocHighlighter()"
    @scroll.window="debouncedScroll"
    class="hidden lg:flex lg:flex-col lg:items-end">
    
      <nav id="TableOfContents">
  <ol>
    <li><a href="#èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ">èƒŒæ™¯å’Œç›¸å…³å·¥ä½œ</a></li>
    <li><a href="#proposed-approach">Proposed approach</a></li>
    <li><a href="#rotary-position-embedding">Rotary position embedding</a></li>
  </ol>
</nav>
    
  </div>
</div>


            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    Â© 2025 dO.ob&#39;s Blog
  </p>
  

  
  <p class="text-sm">
    ğŸŒ±
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
        <div class="back">
          <div class="container">
            
            <div class="max-w-[65ch] mt-8 mx-auto px-4">
  
  
  
  <div>
    <div class="mb-4 text-lg font-medium">å…³äºæˆ‘</div>

    <div class="prose dark:prose-invert">
      <p>æˆ‘æ˜¯ä¸€åAIä»ä¸šè€…ï¼Œè‡´åŠ›äºäººå·¥æ™ºèƒ½å’Œæ•°æ®é©±åŠ¨è¡Œä¸šã€‚</p>
<p>è¸ä¸Šå–ç»è·¯ï¼Œæ¯”æŠµè¾¾çµå±±æ›´é‡è¦</p>

    </div>
  </div>
  <div class="divider divider-vertical"></div>
  
  

  

  
</div>

            

            
<footer class="flex justify-between items-center gap-2 max-w-[65ch] mx-auto px-4 md:px-0 py-12">

  <div>
  
  <p>
    Â© 2025 dO.ob&#39;s Blog
  </p>
  

  
  <p class="text-sm">
    ğŸŒ±
    <span class="text-base-content/60">
      Powered by <a class="hover:underline" href="https://gohugo.io/" target="_blank">Hugo</a> with theme
      <a class="hover:underline" href="https://github.com/g1eny0ung/hugo-theme-dream" target="_blank">Dream</a>.</span
    >
  </p>
  
</div>

  <div
  x-data="{ icons: [
    { name: 'sunny', status: 'n' },
    { name: 'moon', status: 'y' },
    { name: 'desktop', status: 'auto' }
  ] }"
  class="flex items-center gap-2 h-[32px] px-2 bg-base-100 border border-base-content/30 rounded-full"
>
  <template x-for="icon in icons">
    <div
      role="button"
      tabindex="0"
      :aria-label="'Select ' + icon.name + ' mode'"
      class="group inline-flex justify-center items-center p-1 rounded-full cursor-pointer hover:bg-primary"
      :class="$store.darkMode.icon() === icon.name && 'bg-primary'"
      @click="$store.darkMode.toggle(icon.status)"
    >
      <ion-icon
        :name="`${icon.name}-outline`"
        class="group-hover:text-primary-content"
        :class="$store.darkMode.icon() === icon.name && 'text-primary-content'"
      >
      </ion-icon>
    </div>
  </template>
</div>

</footer>

          </div>
        </div>
      </div>
    </div>

    <script>
  window.lightTheme = "emerald"
  window.darkTheme = "forest"
</script>





<script src="/js/main.js"></script>

    







<script src="/js/toc.js"></script>





    

    

    

    

    <script type="module" src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.esm.js" integrity="sha256-/IFmi82bIhdYWctu0UddSlJqpnzWm7Vh2C4CM32wF/k=" crossorigin="anonymous"></script>
    <script nomodule src="https://cdn.jsdelivr.net/npm/ionicons@7.4.0/dist/ionicons/ionicons.js" integrity="sha256-mr7eJMX3VC3F7G32mk4oWp1C6a2tlMYxUdptfT7uKI8=" crossorigin="anonymous"></script>
  </body>
</html>
